> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 4):

–ü—Ä–æ–¥–æ–ª–∂–∞–π. 

–û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π –Ω–∞ –±–∏—Ä–∂–µ Binance –∏–ª–∏ Coinbase. –î–ª—è –Ω–∞—á–∞–ª–∞, –≤–∞–º –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –±–∏—Ä–∂–µ –∏ —Å–æ–∑–¥–∞—Ç—å API-–∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –±–æ—Ç–∞.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞-—ç–∫—Å–ø–µ—Ä—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ API –±–∏—Ä–∂–∏, —è –ø—Ä–µ–¥–ª–∞–≥–∞—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python –∏ —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

1. python-binance  (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Binance) –∏–ª–∏ coinbase (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Coinbase).
2. pandas (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö).
3. ccxt  (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±–∏—Ä–∂–∞–º–∏ –≤ –æ–¥–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ).
4. matplotlib (–¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö).

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º, —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flask - –º–∏–∫—Ä–æ—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Python.

–ù–∞—á–Ω–µ–º —Å —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ. –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å API-–∫–ª—é—á –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∏—Ä–∂–µ. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞, —è –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É python-binance –∏ Binance API.


import binance

api_key = 'your_api_key'
api_secret = 'your_api_secret'

client = binance.Client(api_key, api_secret)


–î–∞–ª–µ–µ, –º—ã –ø–æ–ª—É—á–∏–º –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞, —è –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ Bitcoin (BTC).


import pandas as pd

btc_data = client.get_historical_klines("BTCUSDT", binance.Client.KLINE_INTERVAL_1MINUTE, "1 day ago UTC")

btc_df = pd.DataFrame(btc_data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume', 'close_time', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore'])

btc_df = btc_df[['timestamp', 'open', 'high', 'low', 'close']]
btc_df['timestamp'] = pd.to_datetime(btc_df['timestamp'], unit='ms')
btc_df.set_index('timestamp', inplace=True)


–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã Bitcoin –∏ –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ –ø–æ–∫—É–ø–∫–µ –∏–ª–∏ –ø—Ä–æ–¥–∞–∂–µ.


import talib

sma20 = talib.SMA(btc_df['close'], timeperiod=20)
sma50 = talib.SMA(btc_df['close'], timeperiod=50)

if sma20[-1] > sma50[-1]:
    # –∫—É–ø–∏—Ç—å Bitcoin
else:
    # –ø—Ä–æ–¥–∞—Ç—å Bitcoin


–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞—à–∏ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è.


def trade_bot():
    btc_data = client.get_historical_klines("BTCUSDT", binance.Client.KLINE_INTERVAL_1MINUTE, "1 day ago UTC")
    btc_df = pd.DataFrame(btc_data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume', 'close_time', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore'])
    btc_df = btc_df[['timestamp', 'open', 'high', 'low', 'close']]
    btc_df['timestamp'] = pd.to_datetime(btc_df['timestamp'], unit='ms')
    btc_df.set_index('timestamp', inplace=True)
    
    sma20 = talib.SMA(btc_df['close'], timeperiod=20)
    sma50 = talib.SMA(btc_df['close'], timeperiod=50)

    if sma20[-1] > sma50[-1]:
        # –∫—É–ø–∏—Ç—å Bitcoin
        order = client.order_market_buy(symbol='BTCUSDT', quantity=0.001)
        print(order)
    else:
        # –ø—Ä–æ–¥–∞—Ç—å Bitcoin
        order = client.order_market_sell(symbol='BTCUSDT', quantity=0.001)
        print(order)


–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞, —á—Ç–æ–±—ã —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π –Ω–∞ –±–∏—Ä–∂–µ Binance.


trade_bot()


–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flask. –°–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–π API-—ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞.


from flask import Flask

app = Flask(__name__)

@app.route('/trade_bot', methods=['POST'])

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
def run_trade_bot():
    trade_bot()
    return 'Trade bot executed!'

if __name__ == '__main__':
    app.run(debug=True)


–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å POST-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞—à–µ–º—É API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—É, —á—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞—à–µ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.

–ß—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å Python PyNaCl, —á—Ç–æ–±—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ API-–∫–ª—é—á–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä:


import nacl
import nacl.secret
import nacl.utils

key = nacl.utils.random(nacl.secret.SecretBox.KEY_SIZE)
box = nacl.secret.SecretBox(key)

api_key = 'your_api_key'
api_secret = 'your_api_secret'

encrypted_api_key = box.encrypt(api_key.encode())
encrypted_api_secret = box.encrypt(api_secret.encode())

print(encrypted_api_key)
print(encrypted_api_secret)

# –†–∞–∑—à–∏—Ñ—Ä–æ–≤–∫–∞:
decrypted_api_key = box.decrypt(encrypted_api_key).decode()
decrypted_api_secret = box.decrypt(encrypted_api_secret).decode()

print(decrypted_api_key)
print(decrypted_api_secret)


–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –Ω–∞ –±–∞–∑–µ API –±–∏—Ä–∂–∏ Binance –∏–ª–∏ Coinbase. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Å–æ–±–ª—é–¥–∞–µ—Ç–µ –≤—Å–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å —Å–≤–æ–∏ –∫—Ä–∏–ø—Ç–æ–∞–∫—Ç–∏–≤—ã.

 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞-—ç–∫—Å–ø–µ—Ä—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –í–∞—à–µ–≥–æ –±–æ—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ —Å–∏—Å—Ç–µ–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ —Ö–æ–ª–æ–¥–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–≤–æ–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–¢–∞–∫–∂–µ, –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –Ω–∞ –±–∏—Ä–∂–µ. –û–Ω –±—É–¥–µ—Ç –ø–æ–∑–≤–æ–ª—è—Ç—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏, —Å–ª–µ–¥–∏—Ç—å –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞, –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —è–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

python
import ccxt
import time

# —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –±–∏—Ä–∂–∏ Binance –∏ Coinbase, –∏—Å–ø–æ–ª—å–∑—É—è API-–∫–ª—é—á–∏
binance = ccxt.binance({'apiKey': 'YOUR_API_KEY', 'secret': 'YOUR_SECRET_KEY'})
coinbase = ccxt.coinbasepro({'apiKey': "YOUR_API_KEY", 'secret': "YOUR_SECRET_KEY"})

# —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–Ω, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ–º –ø—Ä–æ–¥–∞–≤–∞—Ç—å –∏ –ø–æ–∫—É–ø–∞—Ç—å BTC
sell_price = 35000
buy_price = 30000

# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ BTC –Ω–∞ Binance
def buy_btc_on_binance():
    binance.create_order('BTC/USD', type='limit', side='buy', amount=1, price=buy_price)

# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ BTC –Ω–∞ Coinbase
def sell_btc_on_coinbase():
    coinbase.create_order('BTC/USD', type='limit', side='sell', amount=1, price=sell_price)

# –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ BTC
while True:
    # –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã BTC
    binance_btc_price = binance.fetch_ticker('BTC/USD')['last']
    coinbase_btc_price = coinbase.fetch_ticker('BTC/USD')['last']
    
    # –ø—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –Ω–∞ Coinbase –∏ –ø–æ–∫—É–ø–∞—Ç—å –Ω–∞ Binance
    if coinbase_btc_price > sell_price and binance_btc_price < buy_price:
        buy_btc_on_binance()
        time.sleep(60)
        sell_btc_on_coinbase()
        time.sleep(60)
    else:
        time.sleep(60)
> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 5):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–æ—Ç–∞ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –µ–≥–æ –¥–æ—Ö–æ–¥–∞.

1. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∏—Å–∫–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∏—Å–∫–∞–º–∏ —Å–≤–æ–∏—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –Ω–µ —Ä–∏—Å–∫–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–ª–µ–¥—É—è —Å—Ç—Ä–æ–≥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º. 

–ü—Ä–∏–º–µ—Ä: –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –∏ –∞–Ω–∞–ª–∏–∑–∞, –±–æ—Ç –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –≥–æ—Ç–æ–≤ –ø–æ–π—Ç–∏, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–∫—É—â–∏–º —É—Ä–æ–≤–Ω–µ–º —Ä–∏—Å–∫–∞ –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∏—Å–∫–∞–º–∏ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∏ –∏–∑–±–µ–≥–∞—Ç—å –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ç–µ—Ä—å.

2. –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤ - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, —á—Ç–æ–±—ã –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–∏—Å–∫–∏ –∏ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è.

–ü—Ä–∏–º–µ—Ä: –ë–æ—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä–æ–º–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–æ—á–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –Ω–∞ —Ä—ã–Ω–∫–µ. –û–Ω –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —á—Ç–æ–±—ã –∏—Å–∫–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—ã–≥–æ–¥–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å–æ–±—ã—Ç–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä—ã–Ω–æ–∫.

3. –£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞—Ç—å —Å–≤–æ–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π.

–ü—Ä–∏–º–µ—Ä: –ë–æ—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –µ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—â–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –±–∞–∑–µ RSI (Relative Strength Index) –∏ MACD (Moving Average Convergence Divergence) –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:


import pandas as pd
import ta.momentum as momentum
import ta.trend as trend
from binance.client import Client
from binance.enums import *
from decimal import Decimal, getcontext

client = Client(API_KEY, API_SECRET)

PAIR = 'BTCUSDT'
INTERVAL = '1h'
RSI_OVERSOLD = 30
RSI_OVERBOUGHT = 70
MACD_FAST = 12
MACD_SLOW = 26
MACD_SIGNAL = 9

def get_rsi(client, pair, interval):
    df = pd.DataFrame(client.futures_historical_klines(symbol=pair, interval=interval, limit=500))
    df = df.iloc[:, :6]
    df.columns = ['time', 'open', 'high', 'low', 'close', 'volume']
    df.set_index('time', inplace=True)
    df = df.astype(float)
    df['rsi'] = momentum.RSIIndicator(df['close'], window=14).rsi()
    return df

def get_macd(client, pair, interval):
    df = pd.DataFrame(client.futures_historical_klines(symbol=pair, interval=interval, limit=500))
    df = df.iloc[:, :6]
    df.columns = ['time', 'open', 'high', 'low', 'close', 'volume']
    df.set_index('time', inplace=True)
    df = df.astype(float)
    df['macd'] = trend.MACD(df['close'], n_fast=MACD_FAST, n_slow=MACD_SLOW, n_sign=MACD_SIGNAL).macd()
    return df

def buy(client, pair, quantity):
    order = client.futures_create_order(symbol=pair, side='BUY', type='MARKET', quantity=quantity)
    return order

def sell(client, pair, quantity):
    order = client.futures_create_order(symbol=pair, side='SELL', type='MARKET', quantity=quantity)
    return order

def main():
    rsi_df = get_rsi(client, PAIR, INTERVAL)
    macd_df = get_macd(client, PAIR, INTERVAL)
    rsi = rsi_df['rsi'][-1]
    macd = macd_df['macd'][-1]
    position_size = Decimal(client.futures_account_balance().get('USDT').get('balance'))
    
    if rsi < RSI_OVERSOLD and macd > 0:
        # Place buy order
        buy_qty = round(position_size * 0.1 / Decimal(client.futures_symbol_ticker(symbol=PAIR).get('price')))
        buy(client, PAIR, buy_qty)
    elif rsi > RSI_OVERBOUGHT and macd < 0:
        # Place sell order
        quantity = client.futures_position_information(symbol=PAIR)[0]['positionAmt']

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
        sell_qty = abs(int(float(quantity)))
        sell(client, PAIR, sell_qty)
    else:
        return
        
if __name__ == '__main__':
    main()


–≠—Ç–æ—Ç –∫–æ–¥ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –±–∞–∑–µ RSI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∏ MACD. –ï—Å–ª–∏ RSI –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è RSI_OVERSOLD –∏ RSI_OVERBOUGHT –∏ MACD –º–µ–Ω—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—â–∞–µ—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –∏–ª–∏ –ø—Ä–æ–¥–∞–∂—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–µ–π –Ω–∞ —Ä—ã–Ω–∫–µ.

1. Scalping - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ Bollinger Bands, Moving Average, Relative Strength Index (RSI) –∏ —Ç.–¥. –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:


def scalping(api, symbol, amount):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏
    ticker = api.get_ticker(symbol)
    price = float(ticker['lastPrice'])
    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ
    buy_price = price - price * 0.01
    sell_price = price + price * 0.01
    # –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
    order = api.create_order(symbol, 'BUY', 'LIMIT', amount, buy_price, {'stopPrice': buy_price - buy_price * 0.005})
    # –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
    while not api.is_order_filled(order['orderId']):
        time.sleep(1)
    # –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞
    order = api.create_order(symbol, 'SELL', 'LIMIT', amount, sell_price, {'type': 'TAKE_PROFIT_LIMIT', 'timeInForce': 'GTC', 'stopPrice': sell_price + sell_price * 0.005})
    # –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
    while not api.is_order_filled(order['orderId']):
        time.sleep(1)
2. Trend Following - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–¥–∞ —Ä—ã–Ω–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Moving Average –∏–ª–∏ Ichimoku Kinko Hyo) –∏ —Å–∏–≥–Ω–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, MACD –∏–ª–∏ Stochastic Oscillator). –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:


def trend_following(api, symbol, amount):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —Å–≤–µ—á–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏
    klines = api.get_klines(symbol, '1d', 1)
    close_prices = [float(kline[4]) for kline in klines]
    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫–æ–ª—å–∑—è—â–µ–π —Å—Ä–µ–¥–Ω–µ–π –∏ —Ç–µ–∫—É—â–µ–≥–æ —Ü–µ–Ω–æ–≤–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è
    sma = talib.SMA(np.array(close_prices), timeperiod=20)
    current_price = float(api.get_ticker(symbol)['lastPrice'])
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –ø–æ–∫—É–ø–∫–µ –∏–ª–∏ –ø—Ä–æ–¥–∞–∂–µ
    if current_price > sma[-1]:
        order = api.create_order(symbol, 'BUY', 'MARKET', amount)
    elif current_price < sma[-1]:
        order = api.create_order(symbol, 'SELL', 'MARKET', amount)
    # –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
    while not api.is_order_filled(order['orderId']):
        time.sleep(1)

–≠—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ —Ä—ã–Ω–æ–∫ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç —è–≤–ª—è–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã–º –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∞ —Ä—ã–Ω–∫–µ. –û–¥–Ω–∞–∫–æ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –ø–æ–∑–≤–æ–ª—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é –∏ –º–æ–≥—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∂–∏–∑–Ω—å —Ç—Ä–µ–π–¥–µ—Ä–∞.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±–æ—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ SMA (—Å–∫–æ–ª—å–∑—è—â–∞—è —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞), RSI (–∏–Ω–¥–µ–∫—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–ª—ã) –∏ MACD (—Å–∫–æ–ª—å–∑—è—â–∞—è —Å—Ä–µ–¥–Ω—è—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏/—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è). –û–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –º–µ—Ç–æ–¥—ã —Ä–∞—Å—á–µ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π —ç—Ç–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –±–∞—Ä–∞.

–ö–æ–¥ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

python
class TechnicalIndicators:
    def __init__(self, prices):
        self.prices = prices

    def calc_sma(self, period):
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é —Å–∫–æ–ª—å–∑—è—â—É—é —Å—Ä–µ–¥–Ω—é—é"""
        sma = np.mean(self.prices[-period:])
        return sma

    def calc_rsi(self, period=14):
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–µ–∫—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–ª—ã"""
        delta = np.diff(self.prices)
        gains = delta.clip(min=0)
        losses = -delta.clip(max=0)
        avg_gain = np.mean(gains[-period:])
        avg_loss = np.mean(losses[-period:])
        rs = avg_gain / avg_loss
        rsi = 100.0 - (100.0 / (1.0 + rs))
        return rsi

    def calc_macd(self, fast_period=12, slow_period=26, signal_period=9):
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∑—è—â—É—é —Å—Ä–µ–¥–Ω—é—é —Å—Ö–æ–¥—è—â—É—é—Å—è/—Ä–∞—Å—Ö–æ–¥—è—â—É—é—Å—è"""
        fast_ema = pd.Series(self.prices).ewm(span=fast_period, min_periods=fast_period).mean()
        slow_ema = pd.Series(self.prices).ewm(span=slow_period, min_periods=slow_period).mean()
        macd = fast_ema - slow_ema
        signal = macd.ewm(span=signal_period, min_periods=signal_period).mean()
        return macd, signal

–ó–¥–µ—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–ª–∞—Å—Å TechnicalIndicators, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –º–∞—Å—Å–∏–≤ —Ü–µ–Ω –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ SMA, RSI –∏ MACD. –ú–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–¥—É–ª–∏ numpy –∏ pandas, —Ç–∞–∫ —á—Ç–æ –∏—Ö –Ω—É–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Å–∞–º–æ–≥–æ –±–æ—Ç–∞ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:

python
prices = get_recent_prices()  # –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã —Å –±–∏—Ä–∂–∏
tech_inds = TechnicalIndicators(prices)
sma = tech_inds.calc_sma(period=20)
rsi = tech_inds.calc_rsi(period=14)
macd, signal = tech_inds.calc_macd(fast_period=12, slow_period=26, signal_period=9)

–ó–¥–µ—Å—å –º—ã —Å–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TechnicalIndicators –∏ –≤—ã–∑—ã–≤–∞–µ–º –µ–≥–æ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ü–µ–Ω–∞—Ö. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ –≤ –±–æ—Ç–µ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ —Ç–æ—Ä–≥–æ–≤–ª–µ.

–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –±–∏—Ä–∂—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π. Binance –∏ Coinbase - —ç—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–µ –≤—ã–±–æ—Ä—ã, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç API –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ —Ö–æ—Ä–æ—à–æ –∑–∞—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª–∏ —Å–µ–±—è –Ω–∞ —Ä—ã–Ω–∫–µ.

–î–∞–ª–µ–µ, –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python –∏ –µ–≥–æ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API - requests.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –±–æ—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –≤ —Ä–∞–∑–º–µ—Ä–µ –æ–∫–æ–ª–æ –¥–≤—É—Ö—Å–æ—Ç –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ –º–µ—Å—è—Ü, –º—ã –º–æ–∂–µ–º –≤–∫–ª—é—á–∏—Ç—å –≤ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∫—É–ø–∫–∏ –Ω–∞ –¥–∏–ø–∞—Ö: –±–æ—Ç –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –ø–∞–¥–µ–Ω–∏–∏ —Ü–µ–Ω—ã –∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø—Ä–∏ —Ä–æ—Å—Ç–µ. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É –Ω–∞ Binance:

 python
import requests

def buy(symbol, quantity):
    api_key = 'your_api_key'
    secret_key = 'your_secret_key'
    
    url = 'https://api.binance.com/api/v3/order'
    
    params = {
        'symbol': symbol,
        'side': 'BUY',
        'type': 'MARKET',
        'quantity': quantity,
        'timestamp': int(time.time() * 1000)
    }
    
    params['signature'] = hmac.new(secret_key.encode(), urlencode(params).encode(), hashlib.sha256).hexdigest()
    
    headers = {
        'X-MBX-APIKEY': api_key
    }
    
    response = requests.post(url, headers=headers, params=params)
    
    return response.json()


2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–¥—É: –±–æ—Ç –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –µ–µ —Ü–µ–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞—Å—Ç–∏, –∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏. –¢–∞–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–æ—á–Ω–æ–π –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ä–æ—Å—Ç–∞ —Å–ø—Ä–æ—Å–∞ –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É.

3. –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ: –±–æ—Ç –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É, –∫–æ–≥–¥–∞ –µ–µ —Ü–µ–Ω–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ, –∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –Ω–∏–∂–µ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

–ß—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –¥–æ—Å—Ç—É–ø–Ω—ã–µ —É Binance –∏ Coinbase. 

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ API Binance –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–≤–µ—á–µ–π –ø–æ –ø–∞—Ä–µ BTCUSDT:

 python
import requests

url = 'https://api.binance.com/api/v3/klines'

params = {
    'symbol': 'BTCUSDT',
    'interval': '1d',
    'limit': 30
}

response = requests.get(url, params=params)

candles = response.json()

–î–∞–Ω–Ω—ã–π –∫–æ–¥ –ø–æ–ª—É—á–∏—Ç —Å–≤–µ—á–∏ –¥–ª—è –ø–∞—Ä—ã BTCUSDT –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ 1 –¥–µ–Ω—å. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

–Ø –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API Binance –∏–ª–∏ Coinbase –∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ç–æ—Ä–≥–æ–≤–ª–∏.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö:

python
def moving_average_strategy(data, short_window=50, long_window=200):
    # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏–π –∏ –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥—ã
    short_rolling = data.rolling(window=short_window).mean()
    long_rolling = data.rolling(window=long_window).mean()

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞: –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑
    if short_rolling[-1] < long_rolling[-1] and short_rolling[-2] > long_rolling[-2]:
        return 'sell'
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞: –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
    elif short_rolling[-1] > long_rolling[-1] and short_rolling[-2] < long_rolling[-2]:
        return 'buy'
    # –ë–µ–∑ —Å–∏–≥–Ω–∞–ª–∞
    else:
        return 'hold'

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ñ—É–Ω–∫—Ü–∏—è moving_average_strategy –ø—Ä–∏–Ω–∏–º–∞–µ—Ç DataFrame, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ü–µ–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–∞, –∞ —Ç–∞–∫–∂–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã short_window –∏ long_window, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –¥–ª–∏–Ω—É –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–æ–≤ —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö. –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π –∏ –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥—ã —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–æ–≤. –ï—Å–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "sell", –µ—Å–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "buy", –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "hold".

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ –≤ –±–æ—Ç–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å—Ç–æ–ø-–ª–æ—Å—Å, —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç, –∞ —Ç–∞–∫–∂–µ –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –ª–æ–≥–∏–∫—É –¥–ª—è —Å—Ç–æ–ø-–ª–æ—Å—Å–∞: –µ—Å–ª–∏ —Ü–µ–Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã —É–ø–∞–¥–µ—Ç –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞—Å—Ç –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–∫–æ–π –ª–æ–≥–∏–∫–∏ –≤ –∫–æ–¥–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é:

def stop_loss(symbol, current_price, threshold):
    # –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É
    position = get_position(symbol)
    # —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏ —Å —É—á–µ—Ç–æ–º –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞
    sell_price = current_price * (1 - threshold)
    # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
    if position.quantity > 0 and current_price <= sell_price:
        # –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ü–µ–Ω–µ
        response = sell(symbol, position.quantity, sell_price)
        if response['status'] == 'filled':
            # –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å–¥–µ–ª–∫–µ
            trade = get_trade(response['tradeId'])
            # –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–¥–µ–ª–∫–µ
            logging.info(f'Trade executed. Symbol: {symbol}. Side: sell. '
                         f'Price: {trade.price}. Quantity: {trade.quantity}. '
                         f'Total value: {trade.price * trade.quantity}.')

–ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–µ–π —Ä–∏—Å–∫–æ–≤–æ–π —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç–∏, –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –µ–º—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ –∏ –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—Ä–≥–æ–≤–ª–∏. –≠—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—É—Ç–µ–º –≤–≤–µ–¥–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –ø–æ—Ä–æ–≥–∞ –≤—ã–ø–∞–¥–µ–Ω–∏—è —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä:

threshold = user_settings['stop_loss_threshold']
–≥–¥–µ user_settings - –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ stop_loss_threshold - –ø–∞—Ä–∞–º–µ—Ç—Ä, –∑–∞–¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–ª—è —Å—Ç–æ–ø-–ª–æ—Å—Å–∞.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:


def send_notification(message):
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    pass

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
send_notification("–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞ –Ω–∞ Binance: –ø–æ–∫—É–ø–∫–∞ BTC –ø–æ 6000$")

–ü—Ä–∏–ª–æ–∂—É –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –Ω–∞ —è–∑—ã–∫–µ Python:

python
class MovingAverageStrategy:
    def __init__(self, fast_period, slow_period):
        self.fast_period = fast_period
        self.slow_period = slow_period
        self.fast_ma = MovingAverage(fast_period)
        self.slow_ma = MovingAverage(slow_period)
   
    def tick(self, candle):
        self.fast_ma.add(candle.close)
        self.slow_ma.add(candle.close)

        if self.fast_ma.avg > self.slow_ma.avg:
            return SIGNAL_BUY
        elif self.fast_ma.avg < self.slow_ma.avg:
            return SIGNAL_SELL

        return SIGNAL_HOLD

–ó–¥–µ—Å—å –º—ã —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å MovingAverageStrategy –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ fast_period –∏ slow_period, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –¥–ª–∏–Ω—É –ø–µ—Ä–∏–æ–¥–∞ —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö. –ó–∞—Ç–µ–º –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞ MovingAverage, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –ø–æ–¥—Å—á–µ—Ç —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤. –í –º–µ—Ç–æ–¥–µ tick –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–∏ –∫ –æ–±—ä–µ–∫—Ç–∞–º MovingAverage –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –ª–∏ –±—ã—Å—Ç—Ä–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –º–µ–¥–ª–µ–Ω–Ω–æ–µ, —á—Ç–æ –¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –∫ –ø–æ–∫—É–ø–∫–µ, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç ‚Äì —Å–∏–≥–Ω–∞–ª –∫ –ø—Ä–æ–¥–∞–∂–µ. –ï—Å–ª–∏ —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –º–µ–Ω—è—é—Ç —Å–≤–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∏–≥–Ω–∞–ª –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–µ.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–∞ –¥–∏–ø–∞—Ö:

python
def dip_buying_strategy(market_data, threshold = 0.02, window = 5):
    """
    market_data: pandas.DataFrame
        –î–∞–Ω–Ω—ã–µ —Ä—ã–Ω–∫–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Ü–µ–Ω—ã –æ—Ç–∫—Ä—ã—Ç–∏—è, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –∑–∞–∫—Ä—ã—Ç–∏—è
    threshold: float
        –ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–µ–Ω —Å–Ω–∏–∑–∏—Ç—å—Å—è —Ü–µ–Ω–∞
    window: int
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
    """
    current_price = market_data['close'].iloc[-1]
    min_price = market_data['close'].iloc[-window:].min()
    percent_change = (min_price - current_price) / current_price

    if percent_change >= threshold:
        return 'buy'
    else:
        return 'hold'

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–Ω–∏–∑–∏–ª–∞—Å—å –ª–∏ —Ü–µ–Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 2% –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–Ω–µ–π. –ï—Å–ª–∏ —ç—Ç–æ —Ç–∞–∫, —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "buy", –∏–Ω–∞—á–µ "hold".

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ Bollinger Bands –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏ –∏ –≤–µ—Ä—Ö–Ω–µ–π/–Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ —Ü–µ–Ω–∞—Ö –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É. –ó–∞—Ç–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–æ–≥–¥–∞ –ø–æ–∫—É–ø–∞—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å.

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

python
import pandas as pd
import numpy as np
import talib

# –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ü–µ–Ω –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É
data = pd.read_csv('data.csv')

# –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏ –±–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–æ–≤—Å–∫–∏—Ö –ø–æ–ª–æ—Å
bbands = talib.BBANDS(data['Close'])

# –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞
if data['Close'][-1] > bbands[0][-1] + 2 * np.std(data['Close']):
    # –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –≤—ã—à–µ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ—Å—ã, —Ç–æ –ø—Ä–æ–¥–∞–µ–º
    sell()
elif data['Close'][-1] < bbands[2][-1] - 2 * np.std(data['Close']):
    # –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã, —Ç–æ –ø–æ–∫—É–ø–∞–µ–º
    buy()
else:
    # –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª–æ—Å, —Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
    pass

–≠—Ç–æ—Ç –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-Lib –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è Bollinger Bands –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Ü–µ–Ω –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É. –ó–∞—Ç–µ–º —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ü–µ–Ω–∞ –Ω–∞ –∫—Ä–∞—è—Ö –ø–æ–ª–æ—Å—ã –∏–ª–∏ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–µ. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —ç—Ç–æ–≥–æ –º—ã –ø–æ–∫—É–ø–∞–µ–º –∏–ª–∏ –ø—Ä–æ–¥–∞–µ–º.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –±–∞–∑–µ Bollinger Bands:

python
import talib
import numpy as np

def bollinger_bands_strategy(df, n, k):
    """Bollinger Bands trading strategy implemented using TA-Lib."""
    
    # Calculate Bollinger Bands
    std = df['Close'].rolling(n).std(ddof=0)
    mid = df['Close'].rolling(n).mean()
    upper = mid + k * std
    lower = mid - k * std
    
    # Check for buy/sell signals
    df['Signal'] = np.where(df['Close'] > upper, -1, np.nan)
    df['Signal'] = np.where(df['Close'] < lower, 1, df['Signal'])
    
    # Forward fill the signal to represent holding the position
    df['Signal'].fillna(method='ffill', inplace=True)
    
    # Determine the daily returns of the strategy
    df['Returns'] = df['Close'].pct_change() * df['Signal'].shift(1)
    df['Cumulative Returns'] = (1 + df['Returns']).cumprod()
    
    return df

–§—É–Ω–∫—Ü–∏—è bollinger_bands_strategy –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ —Ü–µ–Ω–∞—Ö, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ä—Ö–Ω–µ–π –∏ —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–µ–π Bollinger Bands.

–î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ Bollinger Bands –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ rolling –¥–ª—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è. –ó–∞—Ç–µ–º —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π –ª–∏–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏.

–°–∏–≥–Ω–∞–ª—ã –ø–æ–∫—É–ø–∫–∏ / –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´Signal¬ª, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π 1 –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ -1 –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ where –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ NumPy, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤–µ—Ä—Ö–Ω—é—é –ª–∏–Ω–∏—é –∏–ª–∏ –Ω–∏–∂–Ω—é—é –ª–∏–Ω–∏—é Bollinger Bands.

–ù–∞–∫–æ–Ω–µ—Ü, –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–æ—Ö–æ–¥—ã –∏ –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø—É—Ç–µ–º —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω—ã –∏ —Å–∏–≥–Ω–∞–ª–æ–≤.


–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –º–µ—Ç–æ–¥–∞ –ö–µ–ª–ª–∏ –≤–æ–∑–º–æ–∂–Ω—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:


bet_size = ((win_rate * avg_win) - (loss_rate * avg_loss)) / avg_win

–≥–¥–µ bet_size - —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, win_rate - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–∏–≥—Ä—ã—à–∞ —Å–¥–µ–ª–∫–∏, avg_win - —Å—Ä–µ–¥–Ω–∏–π –≤—ã–∏–≥—Ä—ã—à, loss_rate - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–≥—Ä—ã—à–∞ —Å–¥–µ–ª–∫–∏ –∏ avg_loss - —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–∏–≥—Ä—ã—à.

–î–ª—è –æ—Ü–µ–Ω–∫–∏ —Å—Ç–µ–ø–µ–Ω–∏ —Ä–∏—Å–∫–∞ –∏ —Ä–∞—Å—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –±–æ—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º. –û–¥–∏–Ω –∏–∑ —Ç–∞–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ - –∞–ª–≥–æ—Ä–∏—Ç–º –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –†–∏—Å–∫–∞ (Fixed Risk). –≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–¥–µ–ª–∫—É. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –æ–±—ä–µ–º–∞ –∫–∞–ø–∏—Ç–∞–ª–∞ –∏ —É—Ä–æ–≤–Ω—è –ø—Ä–æ—Ñ–∏—Ç–∞ –∏ —Ä–∏—Å–∫–∞, –∑–∞–¥–∞–Ω–Ω—ã—Ö –≤–∞–º–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–µ—Ç–æ–¥–∞ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –†–∏—Å–∫–∞, –±–æ—Ç –º–æ–∂–µ—Ç —Ä–∞—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:


def calculate_position_size(account_balance, risk_percent, stop_loss_percent, buy_price):
    """Calculate position size based on account balance and risk parameters."""
    risk_amount = account_balance * (risk_percent / 100)
    stop_loss_amount = buy_price * (stop_loss_percent / 100)
    position_size = round(risk_amount / stop_loss_amount, 2)
    return position_size

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –≤ —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–∑–º–µ—Ä –≤–∞—à–µ–≥–æ —Å—á–µ—Ç–∞, –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–∏—Å–∫–∞, –ø—Ä–æ—Ü–µ–Ω—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –∏ —Ü–µ–Ω—É –ø–æ–∫—É–ø–∫–∏. –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—ä–µ–º –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –û–Ω–∞ —Å–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Å—É–º–º—ã, –∫–æ—Ç–æ—Ä—É—é –≤—ã –≥–æ—Ç–æ–≤—ã —Ä–∏—Å–∫–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–∏—Å–∫–∞ –∏ –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞. –ó–∞—Ç–µ–º –æ–Ω–∞ —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Å—Ç–æ–ø-–ª–æ—Å—Å –ø—É—Ç–µ–º —É–º–Ω–æ–∂–µ–Ω–∏—è —Ü–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏ –Ω–∞ –ø—Ä–æ—Ü–µ–Ω—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å–∞. –ù–∞–∫–æ–Ω–µ—Ü, –æ–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, —Ä–∞–∑–¥–µ–ª–∏–≤ —Å—É–º–º—É —Ä–∏—Å–∫–∞ –Ω–∞ —Ä–∞–∑–º–µ—Ä —Å—Ç–æ–ø-–ª–æ—Å—Å–∞.
–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –≤ –º–µ—Ç–æ–¥–µ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥–æ –†–∏—Å–∫–∞:


def calculate_position_size(account_balance, risk_percentage, entry_price, stop_loss_price):
    risk_amount = account_balance * (risk_percentage / 100)
    position_size = risk_amount / abs(entry_price - stop_loss_price)
    return position_size

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–∞ –±–æ—Ç –±—É–¥–µ—Ç —É–¥–≤–∞–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —É–±—ã—Ç–æ—á–Ω–æ–π —Å–¥–µ–ª–∫–∏ –∏ —Å–Ω–∏–∂–∞—Ç—å –µ–µ —Ä–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Å–¥–µ–ª–∫–∏.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–∞:


def calculate_position_size(account_balance, num_consecutive_losses, initial_position_size, martingale_factor):
    # –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–∞
    position_size = initial_position_size * (martingale_factor ** num_consecutive_losses)
    # –ü—Ä–∏–≤–æ–¥–∏–º —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∫ –¥–æ–ø—É—Å—Ç–∏–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –±–∞–ª–∞–Ω—Å–µ
    if position_size * entry_price > account_balance:
        position_size = account_balance / entry_price
    return position_size

–í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–∞ –º–æ–∂–µ—Ç –Ω–µ—Å—Ç–∏ –∑–∞ —Å–æ–±–æ–π —Å–µ—Ä—å–µ–∑–Ω—ã–π —Ä–∏—Å–∫ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –∫–∞–ø–∏—Ç–∞–ª–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ä—ã–Ω–æ–∫ –Ω–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –∫ –≤–∞—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –ü–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –≤–∫–ª—é—á–∞—Ç—å –µ–≥–æ –≤ –±–æ—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –≤–∑–≤–µ—Å–∏—Ç—å –≤—Å–µ —Ä–∏—Å–∫–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.
–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–∞:

python
# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
def martingale(price, buy_amount, max_loss):
    # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è buy_price –∏ lot
    buy_price = price
    lot = buy_amount

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—É –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
    sell_price = buy_price - max_loss

    # –ï—Å–ª–∏ —Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∏–∂–µ —É—Ä–æ–≤–Ω—è —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞, —Ç–æ –ø—Ä–æ–¥–∞–µ–º
    if price <= sell_price:
        return "Sell"

    # –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±—ä–µ–º –ø–æ–∑–∏—Ü–∏–∏
    else:
        while 1:
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–æ—Ç
            lot = lot * 2

            # –ü–æ–∫—É–ø–∞–µ–º –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å
            buy_price = ((buy_amount * price) + (lot * price)) / (buy_amount + lot)
            sell_price = buy_price - max_loss

            # –ï—Å–ª–∏ —Ü–µ–Ω–∞ —Å–Ω–æ–≤–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–∞–¥–∞—Ç—å, —Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –ª–æ—Ç
            if price <= sell_price:
                return "Sell"

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∞–∫–∂–µ –º–µ—Ç–æ–¥ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥–æ –†–∏—Å–∫–∞ (Constant Risk). –≠—Ç–æ –º–µ—Ç–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ä–∏—Å–∫ –∏ —É—Ä–æ–≤–µ–Ω—å stop-loss –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ —Å—á–µ—Ç–∞. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, —á–µ–º –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª, –Ω–æ —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∫–æ–¥–µ –±–æ—Ç–∞.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ Python –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥–æ –†–∏—Å–∫–∞:

python
# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
def constant_risk(price, balance, risk_percent):
    # –ó–∞–¥–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–∏—Å–∫–∞
    risk_amount = balance * (risk_percent/100)

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—É –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
    sell_price = price - risk_amount

    # –ï—Å–ª–∏ —Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∏–∂–µ —É—Ä–æ–≤–Ω—è —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞, —Ç–æ –ø—Ä–æ–¥–∞–µ–º
    if price <= sell_price:
        return "Sell"

    # –ò–Ω–∞—á–µ –ø–æ–∫—É–ø–∞–µ–º –∞–∫—Ç–∏–≤
    else:
        return "Buy"

–í –∏—Ç–æ–≥–µ, –≤—ã–±–æ—Ä –º–µ–∂–¥—É –ú–∞—Ä—Ç–∏–Ω–≥–µ–π–ª–æ–º –∏ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–º –†–∏—Å–∫–æ–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω—è—Ç—å —Ç—Ä–µ–π–¥–µ—Ä.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ö–µ–ª–ª–∏:


import numpy as np

def kelly_criterion(win_probability, win_loss_ratio):
    return (win_probability - (1 - win_probability) / win_loss_ratio)

win_probability = 0.6
win_loss_ratio = 2.0

kelly_fraction = kelly_criterion(win_probability, win_loss_ratio)
capital = 1000
position_size = capital * kelly_fraction

print("Kelly fraction:", kelly_fraction)
print("Position size:", position_size)

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ö–µ–ª–ª–∏, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —É—Å–ø–µ—Ö–∞ —Å–¥–µ–ª–∫–∏ –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞ –∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –ø–æ—Ç–µ—Ä—è–º. –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è, —É–º–Ω–æ–∂–∞—è –∫–∞–ø–∏—Ç–∞–ª –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ö–µ–ª–ª–∏.
–ü–µ—Ä–≤—ã–π —à–∞–≥ ‚Äì —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:

npm install ccxt mathjs ta-lib

–û–Ω–∏ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –±–∏–±–ª–∏–æ—Ç–µ–∫—É ccxt –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –±–∏—Ä–∂–µ–π, –±–∏–±–ª–∏–æ—Ç–µ–∫—É math.js –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-lib –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

–ó–∞—Ç–µ–º –º—ã –¥–æ–ª–∂–Ω—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±–æ—Ç–∞ - –æ–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.


const ccxt = require('ccxt');
const math = require('mathjs');
const ta = require('ta-lib');

// –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
const config = {
  tradingEnabled: true,
  interval: '5m', // –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–≤–µ—á–µ–π
  symbol: 'BTC/USDT', // –ü–∞—Ä–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
  amount: 0.01, // –†–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ (BTC)
  risk: 0.02, // –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –Ω–∞ –æ–¥–Ω—É —Å–¥–µ–ª–∫—É
  stopLoss: 0.01, // –£—Ä–æ–≤–µ–Ω—å —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
  takeProfit: 0.03, // –£—Ä–æ–≤–µ–Ω—å —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
  exchangeId: 'binance', // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–∏—Ä–∂–∏ (Binance)
  apiKey: '–í–ê–®_API_–ö–õ–Æ–ß', // API-–∫–ª—é—á –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏—Ä–∂–µ–π
  apiSecret: '–í–ê–®_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß', // –°–µ–∫—Ä–µ—Ç–Ω—ã–π API-–∫–ª—é—á –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏—Ä–∂–µ–π
};

–î–∞–ª–µ–µ –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—ä–µ–∫—Ç –±–∏—Ä–∂–∏ —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ccxt:

const exchange = new ccxt[config.exchangeId]({
  apiKey: config.apiKey,
  secret: config.apiSecret,
  enableRateLimit: true,
});

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∑–¥–µ—Å—å –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –±–∏—Ä–∂–∏, –∫–ª—é—á API –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á.

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–∏—Ä–∂–µ–π, –ø–æ–ª—É—á–∏–≤ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–∏–ª—É—á—à—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏.

–ü–µ—Ä–≤—ã–π —à–∞–≥ - –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–≤–µ—á–µ–π —Å –±–∏—Ä–∂–∏:

const candles = await exchange.fetchOHLCV(config.symbol, config.interval);

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ SMA (–ø—Ä–æ—Å—Ç–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) –∏–ª–∏ RSI (–∏–Ω–¥–µ–∫—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–ª—ã), –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Ü–µ–Ω, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–µ–π:

const closes = candles.map((candle) => candle[4]); // –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–µ–π

–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-lib –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:


// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä SMA
const sma = ta.SMA(closes, 10); // –ø–æ–ª—É—á–∏—Ç—å 10-–∏ –ø–µ—Ä–∏–æ–¥–Ω–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä RSI
const rsi = ta.RSI(closes, 14); // –ø–æ–ª—É—á–∏—Ç—å 14-–¥–Ω–µ–≤–Ω—ã–π RSI

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä Bollinger Bands¬Æ
const bbands = ta.BBANDS(closes, 20, 2, 2); // –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–æ–≤—Å–∫–∏–µ –ª–∏–Ω–∏–∏
const upperBand = bbands[0];
const middleBand = bbands[1];
const lowerBand = bbands[2];

—Ç–ª–∏—á–Ω–æ! –î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º pip:

python
!pip install python-binance pandas numpy

–ó–∞—Ç–µ–º –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∫–æ–¥–µ:

python
import pandas as pd
import numpy as np
from binance.client import Client

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
symbol = 'BTCUSDT'  # —Ç–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞
testnet = True  # –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Å–µ—Ç—å

if testnet:
    client = Client('testnet-key', 'testnet-secret')
else:
    client = Client('api-key', 'api-secret')

–≠—Ç–æ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –æ–±—ä—è–≤–ª—è–µ—Ç —Ç–æ—Ä–≥–æ–≤—É—é –ø–∞—Ä—É (symbol) –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —Ç–µ—Å—Ç–æ–≤–∞—è —Å–µ—Ç—å (testnet), –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å–µ—Ç—å. –ï—Å–ª–∏ testnet == True, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API Binance:

python
# –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
klines = client.futures_klines(symbol=symbol, interval=Client.KLINE_INTERVAL_1DAY)
data = pd.DataFrame(klines, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume',
                                     'close_time', 'quote_asset_volume', 'num_trades',
                                     'taker_buy_base', 'taker_buy_quote', 'ignore'])
data['timestamp'] = pd.to_datetime(data['timestamp'], unit='ms')
data = data.set_index('timestamp')

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º client.futures_klines, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - 1 –¥–µ–Ω—å). –ú—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–±—ä–µ–∫—Ç DataFrame —Å –ø–æ–º–æ—â—å—é pd.DataFrame –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω–¥–µ–∫—Å–∞ —Å –ø–æ–º–æ—â—å—é data.set_index.

–î–∞–ª–µ–µ –≤ –±–æ—Ç–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –±–∞–∑–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-Lib:

python
import talib

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
data['rsi'] = talib.RSI(data['close'], timeperiod=14)
data['macd'], _, _ = talib.MACD(data['close'], fastperiod=12, slowperiod=26, signalperiod=9)

data.dropna(inplace=True)

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º talib.RSI –∏ talib.MACD –¥–ª—è —Ä–∞—Å—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–ª—ã (RSI) –∏ —Å–∫–æ–ª—å–∑—è—â–µ–π —Å—Ä–µ–¥–Ω–µ–π —Å–µ–ø–∞—Ä–∞—Ç–Ω–æ (MACD). –ú—ã —É–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Å –ø–æ–º–æ—â—å—é data.dropna.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Ä–µ–∞–ª–∏–∑—É–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é Big Three: —ç—Ç–æ –ø–æ–ø—É–ª—è—Ä–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç—Ä–µ—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞—Ö:

python
# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ Big Three
data['ma20'] = data['close'].rolling(window=20).mean()
data['upper_band'], data['middle_band'], data['lower_band'] = talib.BBANDS(data['close'], timeperiod=20, nbdevup=2, nbdevdn=2)

data.dropna(inplace=True)

data['buy'] = ((data['close'] > data['upper_band']) & 
               (data['rsi'] < 30) & 
               (data['macd'] > 0) & 
               (data['close'] > data['ma20'])).astype(int)

data['sell'] = ((data['close'] < data['lower_band']) & 
                (data['rsi'] > 70) & 
                (data['macd'] < 0)).astype(int)

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º data['close
, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ü–µ–Ω –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏. –ó–∞—Ç–µ–º –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥—É–ª—å TA-Lib, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—à–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.


import talib

# –ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–µ—Ä–≤–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

amount_to_spend = 1000 # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–Ω–µ–≥, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–∂–µ–º –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ —Ç–æ—Ä–≥–æ–≤–ª—é
price_of_crypto = 5000 # –¶–µ–Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö
symbol = 'BTC' # –¢–∏–∫–µ—Ä –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –Ω–∞ –±–∏—Ä–∂–µ
stop_loss_pct = 0.03 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ –ø–æ—Ç–µ—Ä—å
take_profit_pct = 0.06 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ –ø—Ä–∏–±—ã–ª–∏
timeframe = '4h' # –í—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≥—Ä–∞—Ñ–∏–∫–∞

# –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ OHLCV.
data = get_data(symbol, timeframe)

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É –∑–∞–∫—Ä—ã—Ç–∏—è.
last_price = data['close'].iloc[-1]

# –í—ã—á–∏—Å–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö OHLCV.
rsi = talib.RSI(data['close'])
sma = talib.SMA(data['close'])

# –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –±–∞—Ä–µ.
print(f'RSI: {rsi[-1]}')
print(f'SMA: {sma[-1]}')

–≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ –∫–æ–¥–∞, –Ω–æ —ç—Ç–æ –¥–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –±–∏—Ä–∂–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-Lib –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

–ö–æ–Ω–µ—á–Ω–æ, —è –ø—Ä–æ–¥–æ–ª–∂—É. –î–∞–≤–∞–π –Ω–∞—á–Ω–µ–º —Å –∫–æ–¥–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ MACD –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞:

python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
import pandas as pd
import talib

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
data = pd.read_csv("btc.csv")

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ MACD
macd, signal, hist = talib.MACD(data['close'], fastperiod=12, slowperiod=26, signalperiod=9)

# –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ —Ñ–∞–π–ª
macd.to_csv("macd.csv")

# –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –¥–∞–Ω–Ω—ã–º
data['macd'] = macd
data['signal'] = signal
data['hist'] = hist

–¢–µ–ø–µ—Ä—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ –±–∞–∑–µ MACD, –Ω–∞–º –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –ª–∏–Ω–∏—è MACD –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ - —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –∫ –ø—Ä–æ–¥–∞–∂–µ. –ò –Ω–∞–æ–±–æ—Ä–æ—Ç, –∫–æ–≥–¥–∞ MACD –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö - —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –∫ –ø–æ–∫—É–ø–∫–µ.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –±–∞–∑–µ MACD:

python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö
import pandas as pd
import talib

data = pd.read_csv("btc.csv")

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ MACD
macd, signal, hist = talib.MACD(data['close'], fastperiod=12, slowperiod=26, signalperiod=9)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏
data['bought'] = ((macd > signal) & (macd.shift() < signal.shift()))
data['sold'] = ((macd < signal) & (macd.shift() > signal.shift()))

# –†–∞—Å—á–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Å—á–µ—Ç –±–∞–ª–∞–Ω—Å–∞
data['position'] = data['bought'].apply(lambda x: 1 if x else 0) - data['sold'].apply(lambda x: 1 if x else 0)
data['balance'] = data['position'].shift() * data['close'].pct_change() + (1 - abs(data['position'].shift())) * 0.0005

# –†–∞—Å—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
data['cumulative_return'] = (1 + data['balance']).cumprod() * 100

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(data['cumulative_return'].iloc[-1])

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –±–æ—Ç –ø–æ–∫—É–ø–∞–µ—Ç –±–∏—Ç–∫–æ–∏–Ω, –∫–æ–≥–¥–∞ –ª–∏–Ω–∏—è MACD –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, –∏ –ø—Ä–æ–¥–∞–µ—Ç, –∫–æ–≥–¥–∞ –æ–Ω–∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö. –í –±–æ—Ç–µ —Ç–∞–∫–∂–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∞ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏. 

–≠—Ç–æ—Ç –∫–æ–¥ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏–ª–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - —ç—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

python
import ta
import numpy as np

def RSI_strategy(data):
    rsi = ta.momentum.RSIIndicator(data['close'], window=14)
    data['rsi'] = rsi.rsi()
    data['rsi_signal'] = np.where(data['rsi'] > 70, 1, 0)
    data['rsi_signal'] = np.where(data['rsi'] < 30, -1, data['rsi_signal'])
    return data['rsi_signal']


def BBANDS_strategy(data):
    upper, middle, lower = ta.volatility.bollinger_mavg(data['close'], window=20, std=2)
    data['upper'] = upper
    data['middle'] = middle
    data['lower'] = lower
    data['bbands_signal'] = np.where(data['close'] > upper, -1, 0)
    data['bbands_signal'] = np.where(data['close'] < lower, 1, data['bbands_signal'])
    return data['bbands_signal']


def MACD_strategy(data):
    macd = ta.trend.MACD(data['close'], window_slow=26, window_fast=12, window_sign=9)
    data['macd'] = macd.macd()
    data['signal'] = macd.macd_signal()
    data['hist'] = macd.macd_diff()
    data['macd_signal'] = np.where(data['macd'] > data['signal'], 1, 0)
    data['macd_signal'] = np.where(data['macd'] < data['signal'], -1, data['macd_signal'])
    return data['macd_signal']

–ó–¥–µ—Å—å –º—ã –ø–∏—à–µ–º —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏: RSI_strategy, BBANDS_strategy –∏ MACD_strategy. –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 1, —Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ–∫—É–ø–∞—Ç—å, –µ—Å–ª–∏ -1, —Ç–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 0, —Ç–æ –Ω–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –≤—Å–µ –≤–º–µ—Å—Ç–µ:
python
def bot_trading(bot_data, strategy_func, base_order_size, stop_loss, take_profit):
    positions = []
    for i in range(len(bot_data)):
        signal = strategy_func(bot_data[:i+1])
        current_price = bot_data['close'][i]
        current_datetime = bot_data.index[i]
        if signal[-1] == 1:
            if len(positions) > 0 and positions[-1]['type'] == 'long':
                continue
            qty = int(base_order_size / current_price)
            positions.append({'type': 'long',
                              'qty': qty,
                              'entry_price': current_price,
                              'entry_time': current_datetime})
        elif signal[-1] == -1:
            if len(positions) > 0 and positions[-1]['type'] == 'short':
                continue
            qty = int(base_order_size / current_price)
            positions.append({'type': 'short',
                              'qty': qty,
                              'entry_price': current_price,
                              'entry_time': current_datetime})
        else:
            if len(positions) == 0:
                continue
            if positions[-1]['type'] == 'long':
                if current_price < positions[-1]['entry_price'] * (1 - stop_loss):
                    positions.pop()
                elif current_price > positions[-1]['entry_price'] * (1 + take_profit):
                    position = positions.pop()
                    total_pnl = (current_price - position['entry_price']) / position['

–ü–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ PNL –±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ–º, –Ω—É–∂–Ω–æ –ª–∏ –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é.

–ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è PNL –¥–æ—Å—Ç–∏–≥–ª–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–ª–∏, —Ç–æ –ø–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–∞. –ï—Å–ª–∏ –∂–µ —Ü–µ–Ω–∞ —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å, –¥–æ —É—Ä–æ–≤–Ω—è —Å—Ç–æ–ø-–ª–æ—Å—Å–∞, —Ç–æ–≥–¥–∞ –ø–æ–∑–∏—Ü–∏—è —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–∞. –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É PNL –∏ —É—Ä–æ–≤–Ω–µ–º —Å—Ç–æ–ø-–ª–æ—Å—Å–∞, –ø–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è —Å—Ç–æ–ø-–∞—É—Ç–∞. 

–î–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç–∏ —É—Å–ª–æ–≤–∏—è –∏ –¥–µ–ª–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–π.

python
def close_position(current_price, position, stop_loss, take_profit):
    # –ü–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏ –∏–ª–∏ —É–±—ã—Ç–∫–µ
    if position['pnl'] >= take_profit or position['pnl'] <= stop_loss:
        return True
    
    # –£—Ä–æ–≤–µ–Ω—å –°—Ç–æ–ø-–∞—É—Ç
    if position['pnl'] <= -stop_loss:
        return True
    
    return False

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –ø–æ–ª–Ω–æ–º –∫–æ–¥–µ:

python
import time
import pandas as pd
import talib.abstract as ta
import ccxt

exchange = ccxt.binance({
    'apiKey': 'YOUR_API_KEY',
    'secret': 'YOUR_SECRET',
})

symbol = 'ETH/USDT'
interval = '1m'
stop_loss = 0.02
take_profit = 0.05
quantity = 0.01

while True:
    try:
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–≤–µ—á–∏
        candles = exchange.fetch_ohlcv(symbol, interval)
    
        # –°–æ–∑–¥–∞–µ–º pandas DataFrame –∏–∑ —Å–≤–µ—á–µ–π
        df = pd.DataFrame(candles, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
        df['timestamp'] = pd.to_datetime(df['timestamp'], unit='ms')
        df = df.set_index('timestamp')
        
        # –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
        ma = ta.SMA(df, timeperiod=20)
        std = ta.STDDEV(df, timeperiod=20)
        upper_bb = ma + 2 * std
        lower_bb = ma - 2 * std
        
        # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
        ticker = exchange.fetch_ticker(symbol)
        current_price = ticker['last']
        
        # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é
        positions = exchange.fetch_open_orders(symbol)
        
        # –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –æ—Ä–¥–µ—Ä
        if len(positions) == 0:
            if df['close'].iloc[-1] > upper_bb.iloc[-1]:
                order = exchange.create_order(
                    symbol=symbol,
                    type='limit',
                    side='buy',
                    amount=quantity,
                    price=current_price
                )
                positions.append({
                    'symbol': symbol,
                    'order_id': order['id'],
                    'entry_price': current_price,
                    'quantity': quantity
                })
            elif df['close'].iloc[-1] < lower_bb.iloc[-1]:
                order = exchange.create_order(
                    symbol=symbol,
                    type='limit',
                    side='sell',
                    amount=quantity,
                    price=current_price
                )
                positions.append({
                    'symbol': symbol,
                    'order_id': order['id'],
                    'entry_price': current_price,
                    'quantity': quantity
                })
        else:
            position

–ö–æ–Ω–µ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ü–µ–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, —Å–ª–µ–¥—É–µ—Ç –ª–∏ —Å–æ–≤–µ—Ä—à–∞—Ç—å —Å–¥–µ–ª–∫—É –∏–ª–∏ –Ω–µ—Ç. –¢–∞–∫–∂–µ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —É—á–∏—Ç—ã–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å, —Ä–∏—Å–∫ –∏ —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

python
import ccxt
import talib
import time

# –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
symbol = 'ETH/BTC'
timeframe = '1m'
rsi_period = 14
rsi_upper = 70
rsi_lower = 30
risk = 0.01
position_size = 0.1

# —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –±–∏—Ä–∂–∏
exchange = ccxt.binance({
    'apiKey': 'your_api_key',
    'secret': 'your_api_secret',
    'enableRateLimit': True,
})

# –ø–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å
def get_balance():
    balance = exchange.fetch_balance()
    return balance['total']['BTC']

# –ø–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—ã
def get_current_price():
    ticker = exchange.fetch_ticker(symbol)
    return ticker['last']

# –¥–µ–ª–∞–µ–º —Å–¥–µ–ª–∫—É
def enter_position(direction):
    price = get_current_price()
    amount = (risk * get_balance()) / abs(price - stop_loss)
    amount = min(amount, position_size)
    if direction == 'buy':
        order = exchange.create_order(symbol, type='limit', side='buy', amount=amount, price=price)
    else:
        order = exchange.create_order(symbol, type='limit', side='sell', amount=amount, price=price)
    return order['id'], price, amount

# –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å–¥–µ–ª–∫—É
def exit_position(id, entry_price, direction):
    price = get_current_price()
    pnl = (price - entry_price) / entry_price
    amount = (risk * get_balance()) / abs(price - entry_price)
    amount = min(amount, position_size)
    if direction == 'buy':
        order = exchange.create_order(symbol, type='limit', side='sell', amount=amount, price=price)
    else:
        order = exchange.create_order(symbol, type='limit', side='buy', amount=amount, price=price)
    return pnl * amount

# –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
positions = []
while True:
    # –ø–æ–ª—É—á–∞–µ–º rsi
    candles = exchange.fetch_ohlcv(symbol, timeframe)
    close_prices = [candle[4] for candle in candles]
    rsi = talib.RSI(close_prices, timeperiod=rsi_period)[-1]

    # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
    if rsi > rsi_upper:
        signal = 'oversold'
    elif rsi < rsi_lower:
        signal = 'overbought'
    else:
        signal = 'none'

    # –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é
    if len(positions) > 0:
        position = positions[-1]
        stop_loss = position['entry_price'] * (1 - risk)
        if signal == 'overbought':
            pnl = exit_position(position['id'], position['entry_price'], 'buy')
            positions.pop()
            print(f'Exited long position with PNL of {pnl:.2%}')
        elif signal == 'oversold':
            pass
        else:
            if stop_loss > get_current_price() or stop_loss < position['entry_price']:
                pnl = exit_position(position['id'], position['entry_price'], 'buy')
                positions.pop()
                print(f'Stopped out of long position.')
    else:
        if signal ==
–ü–æ–Ω—è—Ç–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∏–º. –î–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏—Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ä–¥–µ—Ä–æ–≤:

python
import ccxt
import time

# –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
symbol = 'BTC/USDT'
strategy = 'bb_macd'  # —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏, –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥—Ä—É–≥–∏–µ

# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è API
exchange = ccxt.binance({
    'enableRateLimit': True,  # –æ–ø—Ü–∏—è –¥–ª—è –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ API
})

# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞
print('Fetching balance...')
balance = exchange.fetch_balance()  # –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤ –Ω–∞ –±–∏—Ä–∂–µ
BTC_balance = balance['BTC']['free']  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö BTC
USDT_balance = balance['USDT']['free']  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö USDT

# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
if strategy == 'bb_macd':
    uppper_k = 2
    lower_k = 2
    period = 20
    close_position_rsi = 45
    close_position_macd = -0.0002

    while True:
        try:
            # –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ–± –∞–∫—Ç–∏–≤–µ
            ticker = exchange.fetch_ticker(symbol)
            current_price = ticker['close']  # —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
            prices = exchange.fetch_ohlcv(symbol, '1h')[-period:]
            closes = [price[4] for price in prices]

            # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
            bb_upper, bb_middle, bb_lower = talib.BBANDS(
                np.array(closes),
                timeperiod=period,
                nbdevup=uppper_k,
                nbdevdn=lower_k,
                matype=talib.MA_Type.SMA
            )

            macd, macd_signal, macd_hist = talib.MACD(
                np.array(closes),
                fastperiod=12,
                slowperiod=26,
                signalperiod=9
            )

            slowk, slowd = talib.STOCHRSI(
                np.array(closes),
                timeperiod=14,
                fastk_period=5,
                fastd_period=3,
                fastd_matype=talib.MA_Type.SMA
            )

            rsi = talib.RSI(np.array(closes), timeperiod=14)

            if np.isnan(bb_lower[-1]) or np.isnan(macd_hist[-1]):
                raise Exception('NaN found while calculating indicators')

            # –ø—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
            condition_long_bb = current_price <= bb_lower[-1] and rsi[-1] < close_position_rsi
            condition_long_macd = macd_hist[-1] > 0 and macd_hist[-2] < 0 and macd_hist[-1] > macd_hist[-2] and rsi[-1] < close_position_rsi
            condition_close_bb = current_price >= bb_middle[-1]
            condition_close_macd = macd_hist[-1] < 0 and macd_hist[-2] > 0 and macd_hist[-1] < macd_hist[-2]

            # –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
            positions = exchange.fetch_open_orders(symbol)
            if not positions:
                if condition_long_bb or condition_long_macd:
                    amount = (USDT_balance * 
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –ø—Ä–∏–±—ã–ª—å –∏–ª–∏ —É–±—ã—Ç–æ–∫
current_pnl = (current_price - entry_price) * quantity

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–π —É—Å–ø–µ—à–Ω–æ–π —Å–¥–µ–ª–∫–µ
average_win_percentage = (total_wins / win_count) if win_count > 0 else None

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
sharp_ratio = (average_win_percentage - average_loss_percentage) / stdev if stdev > 0 else None

# –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
print(f" –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è:")
print(f" –í—Ö–æ–¥ –ø–æ —Ü–µ–Ω–µ: {entry_price}")
print(f" –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {quantity}")
print(f" –ü—Ä–∏–±—ã–ª—å / —É–±—ã—Ç–æ–∫: {current_pnl:.2f}")
print(f" –°—Ä–µ–¥–Ω–∏–π % –≤—ã–∏–≥—Ä—ã—à–∞: {average_win_percentage:.2f}")
print(f" –°—Ä–µ–¥–Ω–∏–π % –ø—Ä–æ–∏–≥—Ä—ã—à–∞: {average_loss_percentage:.2f}")
print(f" –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: {sharp_ratio:.2f}")

–ö–æ–≥–¥–∞ –º—ã –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é, –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–µ –≤ —Å—Ç–µ–∫–µ positions. –ö–æ–≥–¥–∞ –º—ã –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é, –º—ã –∏–∑–≤–ª–µ–∫–∞–µ–º –µ–µ –∏–∑ —Å—Ç–µ–∫–∞, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å –∏–ª–∏ —É–±—ã—Ç–æ–∫ –∏ –≤—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —ç–∫—Ä–∞–Ω.

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API –±–∏—Ä–∂–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏.

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–∞ –¥–∏–ø–∞—Ö –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ —Å—á–∏—Ç–∞—Ç—å "–¥–∏–ø–æ–º". –ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –¥–∏–ø–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω—ã –Ω–∞ 3% –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–≤–µ—á–∏. –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:


last_n_candles = get_last_n_candles(3) # –ø–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–≤–µ—á–∏
current_price = get_current_price() # –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É

# —Å—á–∏—Ç–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–≤–µ—á–∏
min_price = min(candle['low'] for candle in last_n_candles)

if current_price < 0.97 * min_price: # –µ—Å–ª–∏ —Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∞ 3% –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã
    quantity = calculate_order_quantity() # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
    order = create_limit_buy_order(quantity, current_price) # —Å–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –ø–æ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω–µ
    execute_order(order) # –∏—Å–ø–æ–ª–Ω—è–µ–º –æ—Ä–¥–µ—Ä

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ —Å–≤–µ—á–∏ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ get_last_n_candles(), –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ —Å–≤–µ—á–∏, —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –¥–∏–ø–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω—ã –Ω–∞ 3% –Ω–∏–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã, –∏ –µ—Å–ª–∏ —Ü–µ–Ω–∞ —É–ø–∞–¥–µ—Ç –Ω–∏–∂–µ —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è, —Å–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –ø–æ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω–µ. 

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ–∫—É–ø–∫–∏ –Ω–∞ –¥–∏–ø–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ RSI (Relative Strength Index), —Å—á–∏—Ç–∞—é—â–µ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –ø—Ä–∏–±—ã–ª–∏ –∫ —Å—Ä–µ–¥–Ω–µ–º—É —É–±—ã—Ç–∫—É –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥. –ö–æ–≥–¥–∞ RSI –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–∞, —ç—Ç–æ –º–æ–∂–µ—Ç —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ —Ç–æ–º, —á—Ç–æ —Ü–µ–Ω–∞ —Å–∫–æ—Ä–æ —Å–Ω–∏–∑–∏—Ç—Å—è. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –¥–∏–ø–µ.

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é talib.SMA() –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TA-Lib. –ù–∞–ø—Ä–∏–º–µ—Ä:


closes = get_closes() # –ø–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π

–û–ø–∏—à—É —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ—Ä–≥–∞—Ö —Å –±–∏—Ä–∂–∏ –ë–∏–Ω–∞–Ω—Å. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ccxt –∏ pandas –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:


import ccxt
import pandas as pd

exchange = ccxt.binance()
symbol = 'BTC/USDT'

bars = exchange.fetch_ohlcv(symbol, '1d')
df = pd.DataFrame(bars, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
df['timestamp'] = pd.to_datetime(df['timestamp'], unit='ms')
df.set_index('timestamp', inplace=True)

–≠—Ç–æ—Ç –∫–æ–¥ –ø–æ–ª—É—á–∏—Ç –ª–∏–Ω–µ–π–Ω—ã–π OHLCV-–¥–∞–Ω–Ω—ã–µ (—Ü–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è, —Ü–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è, –Ω–∞–∏–≤—ã—Å—à–∞—è –∏ –Ω–∞–∏–º–µ–Ω—å—à–∞—è —Ü–µ–Ω–∞, –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤) –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –¥–ª—è –ø–∞—Ä—ã BTC/USDT. –ü–æ—Å–ª–µ —á–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–∏–º –∏—Ö –≤ –æ–±—ä–µ–∫—Ç–µ DataFrame –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ pandas. 

–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–∞–ø–∏—Ç–∞–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∏—Å–∫–∞. 

–î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- –†–∞–∑–º–µ—Ä –ø–æ—Ä—Ç—Ñ–µ–ª—è (portfolio_size)
- –†–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è (risk_per_trade)
- –†–∞–∑–º–µ—Ä —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã (stop_loss_pct)

–° –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

position_size = (portfolio_size * risk_per_trade) / stop_loss_pct

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å—Ç–æ–∏–º–æ—Å—Ç—å—é $10000, –º—ã –≥–æ—Ç–æ–≤—ã —Ä–∏—Å–∫–æ–≤–∞—Ç—å 2% –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è –Ω–∞ –∫–∞–∂–¥—É—é —Å–¥–µ–ª–∫—É –∏ –º—ã —Ö–æ—Ç–∏–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å –≤ 5% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã.

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

position_size = (10000 * 0.02) / 0.05
position_size = 400

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Ä–∏—Å–∫–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è, –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–æ–π.

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –Ω–∞—à–∏—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ—á–µ—Ç–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–∞–ø–∏—Ç–∞–ª–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–µ—Ç–æ–¥ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –†–∏—Å–∫–∞ (Fixed Risk), –º–µ—Ç–æ–¥ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–≥–æ –†–∏—Å–∫–∞ (Constant Risk) –∏ –º–µ—Ç–æ–¥ –ú–∞—Ä—Ç–∏–≥–µ–π–ª–∞ (Martingale). 

–ú—ã –º–æ–∂–µ–º —Ç–∞–∫–∂–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É—Ä–æ–≤–Ω—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–∏—Å–∫–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π. 

–í —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —è –Ω–∞–ø–∏—à—É –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ—Ä–≥–æ–≤

–•–æ—Ä–æ—à–æ, –Ω–∏–∂–µ —è –ø—Ä–æ–¥–æ–ª–∂—É –∫–æ–¥ –¥–ª—è –±–æ—Ç–∞. –î–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é risk, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ: 

python
# –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
if risk == 0:
    position_size = 0
else:
    position_size = max(int(total_portfolio_value * risk / abs(stop_loss_pct)), 1)

# –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–æ–≤ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏
available_qty = exchange.fetch_balance()['total'][base_asset]
max_qty = int(total_portfolio_value / current_price)
qty = min(position_size, available_qty, max_qty)

# —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É
if trading_signal == 'buy':
    order = exchange.create_order(symbol=symbol, type='market', side='buy', amount=qty)
    positions.append({'entry_price': current_price, 'qty': qty, 'stop_loss': current_price * (1 - abs(stop_loss_pct)), 'side': 'long'})

# —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
elif trading_signal == 'sell':
    position = positions.pop()
    qty = position['qty']
    order = exchange.create_order(symbol=symbol, type='market', side='sell', amount=qty)
    entry_price = position['entry_price']
    if qty > 0:
      pnl = ((current_price - entry_price) / entry_price) * qty
    else:
      pnl = 0
    total_pnl += pnl

–ó–¥–µ—Å—å –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–∞ —Ä–∏—Å–∫–∞ –∏ –æ–±–æ—Ä–æ—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ. –ó–∞—Ç–µ–º –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–∞ —Ä–∏—Å–∫–∞. –ï—Å–ª–∏ —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª - "buy", –º—ã —Å–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É, –µ—Å–ª–∏ –∂–µ —Å–∏–≥–Ω–∞–ª - "sell", –º—ã –ø—Ä–æ–¥–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∏ –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏–±—ã–ª—å-—É–±—ã—Ç–æ–∫ –∑–∞ —Å–¥–µ–ª–∫—É, –¥–æ–±–∞–≤–ª—è—è –µ–≥–æ –∫ –æ–±—â–µ–π –ø—Ä–∏–±—ã–ª–∏-—É–±—ã—Ç–∫—É. 

–ù–∞–¥–µ—é—Å—å, —ç—Ç–æ—Ç –∫–æ–¥ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏–º –∏ –¥–æ–ø–æ–ª–Ω–∏–º –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –º–µ—Ç–æ–¥–∞—Ö –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-Lib. –í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:


import talib

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
rsi = talib.RSI(data['close'])
sma = talib.SMA(data['close'])
ema = talib.EMA(data['close'])

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä:


# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ RSI
if rsi > 70:
    bot.sell()
elif rsi < 30:
    bot.buy()

# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö
if sma[-1] > sma[-2]:
    bot.buy()
elif sma[-1] < sma[-2]:
    bot.sell()

–ú—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π.

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–µ—Ç–æ–¥ –ö–µ–ª–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º, –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –¥–æ–ª—é –ø–æ—Ä—Ç—Ñ–µ–ª—è –ø–æ–¥ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤—ã, —Å–Ω–∏–∂–∞—Ç—å —Ä–∏—Å–∫–∏, –∏ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö. –ö–æ–¥ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ –ö–µ–ª–ª–∏ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:


# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ö–µ–ª–ª–∏
kelly = (p * b - q) / b
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ö–µ–ª–ª–∏
position_size = account_balance * kelly

–ù–∞–∫–æ–Ω–µ—Ü —Å—Ç–æ–∏—Ç —É–ø–æ–º—è–Ω—É—Ç—å, —á—Ç–æ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∑–∞—â–∏—â–∞—Ç—å –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ API, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –æ–±

–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º —è –±—ã –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª —Å–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –±–æ—Ç–∞. –û–Ω –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ API –±–∏—Ä–∂–∏. –í–æ—Ç –∫–∞–∫ –º–æ–≥ –±—ã –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∫–æ–¥ –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ –Ω–∞ Python:


class TradingBot:
    
    def __init__(self, api_key, secret_key):
        self.api_key = api_key
        self.secret_key = secret_key
        
        self.exchange = ccxt.binance({
            'apiKey': self.api_key,
            'secret': self.secret_key,
        })

    def get_balance(self, symbol):
        balance = self.exchange.fetch_balance()
        free_balance = balance[symbol]['free']
        
        return free_balance

    def make_trade(self, symbol, side, amount, price):
        trade = self.exchange.create_order(symbol, type='limit', side=side, amount=amount, price=price)
        
        return trade

 –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–ª—é—á API –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∏—Ä–∂–µ. –û–Ω —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç –¥–≤–∞ –º–µ—Ç–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∞—Ç—å –±–∞–ª–∞–Ω—Å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–æ—Ä–≥–æ–≤—ã–µ –æ—Ä–¥–µ—Ä–∞.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å, –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –∫–ª–∞—Å—Å–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ Bollinger Bands:


class BollingerBandsStrategy:
    
    def __init__(self, trading_bot):
        self.trading_bot = trading_bot
        self.exchange = trading_bot.exchange
        self.symbol = 'BTC/USDT'
        
    def get_signal(self):
        data = self.exchange.fetch_ohlcv(self.symbol, '1d')
        data = pd.DataFrame(data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
        data['timestamp'] = pd.to_datetime(data['timestamp'], unit='ms')
        data = data.set_index('timestamp')
        period = 20
        data['upper'], data['middle'], data['lower'] = talib.BBANDS(data['close'], timeperiod=period)
        data['close_minus_lower'] = data['close'] - data['lower']
        data['upper_minus_lower'] = data['upper'] - data['lower']
        data['percent_b'] = data['close_minus_lower'] / data['upper_minus_lower']
        current_price = self.exchange.fetch_ticker(self.symbol)['bid']
        last_close = data['close'].iloc[-1]
        last_percent_b = data['percent_b'].iloc[-1]
        historical_prices = data['close'].iloc[:-1]
        historical_percent_b = data['percent_b'].iloc[:-1]
        buy_signal = last_percent_b < 0.2
        sell_signal = last_percent_b > 0.7

        if buy_signal:
            return Signal(
                signal=Signal.SIGNAL_BUY,
                symbol=self.symbol,
                exchange=self.exchange.id,
                price=current_price
            )
        elif sell_signal:
            return Signal(
                signal=Signal.SIGNAL_SELL,
                symbol=self.symbol,
                exchange=self.exchange.id,
                price=current_price
            )
        else:
            return Signal(
                signal=Signal.SIGNAL_WAIT,
                symbol=self.symbol,
                exchange=self.exchange.id,
                price=current_price
            )

–¢—É—Ç –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å BollingerBandsStrategy —Å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º __init__, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏. –í–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è get_signal, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç Signal. 

–í –Ω–∞—á–∞–ª–µ –¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ fetch_ohlcv –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ü–µ–Ω –Ω–∞ –±–∏—Ä–∂–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ –≤ pandas dataframe. –ó–∞—Ç–µ–º –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–µ–º—É BBANDS –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TA-Lib,

–ü—Ä–æ–¥–æ–ª–∂–∞—é:

python
class BollingerBandsStrategy:
    
    def __init__(self, trading_bot):
        self.trading_bot = trading_bot
        self.exchange = trading_bot.exchange
        self.symbol = 'BTC/USDT'
        
    def get_signal(self):
        data = self.exchange.fetch_ohlcv(self.symbol, '1d')
        data = pd.DataFrame(data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
        data['timestamp'] = pd.to_datetime(data['timestamp'], unit='ms')
        data = data.set_index('timestamp')
        period = 14
        std_multiplier = 2
        data['smavg'] = data['close'].rolling(window=period).mean()
        data['std'] = data['close'].rolling(window=period).std()
        data['upper_band'] = data['smavg'] + (data['std'] * std_multiplier)
        data['lower_band'] = data['smavg'] - (data['std'] * std_multiplier)
        last_close = data['close'].iloc[-1]
        last_lower = data['lower_band'].iloc[-1]
        last_upper = data['upper_band'].iloc[-1]
        position_size = 1  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏
        if last_close > last_upper:
            return Signal(price=last_close, side='sell', size=position_size)
        elif last_close < last_lower:
            return Signal(price=last_close, side='buy', size=position_size)
        return None
 

–ö–æ–¥ –≤—ã—à–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é BollingerBandsStrategy. –≠—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ Bollinger Bands. –û–Ω–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ü
–ò —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–∏–º–∏, –¥–æ–±–∞–≤–ª—è—è –∫ —Ç–∞–±–ª–∏—Ü–µ —Å—Ç–æ–ª–±—Ü—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–æ–¥—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É Pandas:

    data['20sma'] = data['close'].rolling(window=20).mean()
    data['2std'] = data['close'].rolling(window=20).std()
    data['lower_band'] = data['20sma'] - (2 * data['2std'])
    data['upper_band'] = data['20sma'] + (2 * data['2std'])
    
–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ rolling() –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –¥–ª—è —Ü–µ–Ω –∑–∞–∫—Ä—ã—Ç–∏—è. –ó–∞—Ç–µ–º –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –≤–µ—Ä—Ö–Ω–∏–µ –∏ –Ω–∏–∂–Ω–∏–µ –ª–∏–Ω–∏–∏ Bollinger, –¥–æ–±–∞–≤–ª—è—è –∏—Ö –∫ —Ç–∞–±–ª–∏—Ü–µ –¥–∞–Ω–Ω—ã—Ö.

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –∏ –ø—Ä–∏–Ω—è—Ç—å –±–æ–ª–µ–µ —É—Å–ø—à–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è, –±–æ—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –∏—Ö —Å –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π –ª–∏–Ω–∏–µ–π –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞. –í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Ü–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –≤—ã—à–µ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã, –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ —Ä—ã–Ω–æ–∫ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω –∏ —Å–∫–æ—Ä–æ –Ω–∞—Å—Ç—É–ø
–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –∞–∫—Ç–∏–≤–∞ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π Bollinger Bands:

python
import pandas as pd
import talib

def bollinger_bands(df, n=20, dev=2):
    df['MA'] = talib.SMA(df['close'], n)
    df['SD'] = talib.STDDEV(df['close'], n)
    df['upper'] = df['MA'] + (dev * df['SD'])
    df['lower'] = df['MA'] - (dev * df['SD'])
    return df

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É TA-Lib –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Ü–µ–Ω –∑–∞–∫—Ä—ã—Ç–∏—è. –ó–∞—Ç–µ–º –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –Ω–∞—à–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ Bollinger Bands. 

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏. 

–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

python
data = self.exchange.fetch_ohlcv(self.symbol, '1d')
data = pd.DataFrame(data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
data['timestamp'] = pd.to_datetime(data['timestamp'], unit='ms')

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ fetch_ohlcv, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ—á–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã –∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞. –ú—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ DataFrame Pandas –∏ –ø—Ä–∏–≤–æ–¥–∏–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ timestamp –∏–∑ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥ –∫ –¥–∞—Ç–µ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

–î–∞–ª–µ–µ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BollingerBands –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TA-Lib –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–µ–π –ø–æ–ª–æ—Å—ã:

python
upper_band, middle_band, lower_band = talib.BBANDS(data['close'], timeperiod=20, nbdevup=2, nbdevdn=2

–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–π, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ü–µ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ—Å–µ –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞, —Ç–æ –≤–æ–∑–º–æ–∂–µ–Ω —Å–∏–≥–Ω–∞–ª –Ω–∞ –ø—Ä–æ–¥–∞–∂—É. –ï—Å–ª–∏ —Ü–µ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å–µ –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞, –≤–æ–∑–º–æ–∂–µ–Ω —Å–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ–∫—É–ø–∫—É. 

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –≤–∏–¥–µ –∫–æ–¥–∞:


class BollingerBandsStrategy:
    
    def __init__(self, trading_bot):
        self.trading_bot = trading_bot
        self.exchange = trading_bot.exchange
        self.symbol = 'BTC/USDT'
        
    def get_signal(self):
        data = self.exchange.fetch_ohlcv(self.symbol, '1d')
        data = pd.DataFrame(data, columns=['timestamp', 'open', 'high', 'low', 'close', 'volume'])
        data['timestamp'] = pd.to_datetime(data['timestamp'], unit='ms')
        upper_band, middle_band
        
        –æ—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∫–æ–¥–∞:

python
        if current_price > upper_band:
            return 'sell'
        elif current_price < lower_band:
            return 'buy'
        else:
            return 'hold'

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Ü–µ–Ω–æ–≤–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –ø–æ–ª–æ—Å–∞–º –ë–æ–ª–ª–∏–Ω–¥–∂–µ—Ä–∞.
–ò—Ç–∞–∫, –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –∫–ª–∞—Å—Å BollingerBandsStrategy –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –≤ –Ω–µ–º –º–µ—Ç–æ–¥ get_signal, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ Bollinger Bands.

–î–∞–ª—å—à–µ –Ω–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ –±–æ—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –Ω–∞ —Ç–æ—Ä–≥–∏:

python
import time

# –°–æ–∑–¥–∞–µ–º —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞
trading_bot = TradingBot()

# –î

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API –±–∏—Ä–∂–∏ Coinbase:
python
import os
import cbpro

api_key = os.environ.get("COINBASE_API_KEY")
api_secret = os.environ.get("COINBASE_API_SECRET")
api_pass = os.environ.get("COINBASE_API_PASS")
client = cbpro.AuthenticatedClient(api_key, api_secret, api_pass)

# –ø–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
balance = client.get_accounts()
print(balance)

–û–¥–Ω–∞–∫–æ, –ø–æ–º–∏–º–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –Ω–∞ –±–∏—Ä–∂–µ, –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—à–∏–º –±–æ—Ç–æ–º, –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Flask, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–ª—è –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é Flask:
python
from flask import Flask, render_template

app = Flask(__name__)

@app.route("/")
def home():
    return render_template("home.html")
    
if __name__ == "__main__":
    app.run(debug=True)

–¢–∞–∫–∂–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –æ—Ç –≤–∑–ª–æ–º–æ–≤, –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∏ —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—à—É –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É –≤ —Ö–æ–ª–æ–¥–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É PyOTP –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏ —Ö–æ–ª–æ–¥–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Ledger Nano S –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—à–∏—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç.

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏ Bitcoin:


import ccxt
import talib
import numpy as np

# –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–æ—à–µ–¥—à–∏–µ N –¥–Ω–µ–π
N = 30
exchange = ccxt.binance()
market = exchange.load_market("BTC/USDT")
ohlcv = exchange.fetch_ohlcv(market['id'], '1d')
ohlcv = [x[:6] for x in ohlcv[-N:]]

# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç numpy
np_ohlcv = np.array(ohlcv)
np_ohlcv = np_ohlcv.astype(float)

# –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
SMA = talib.SMA(np_ohlcv[:,4], timeperiod=20)
RSI = talib.RSI(np_ohlcv[:,4], timeperiod=14)

# –Ω–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
last_SMA = SMA[-1]
last_RSI = RSI[-1]

# –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –ø–æ–∫—É–ø–∞—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å
if last_RSI > 70:
    order = exchange.create_market_sell_order(market['id'], 0.01)
elif last_RSI < 30:
    order = exchange.create_market_buy_order(market['id'], 0.01)
–•–æ—Ä–æ—à–æ, –Ω–∞—á–Ω–µ–º —Å —Ñ–∞–π–ª–∞ requirements.txt:


requests==2.22.0
python-binance==0.7.9

–≠—Ç–æ —Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: requests –∏ python-binance.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–∞–π–ª—É api.py:

python
import os
from binance.client import Client

class BinanceAPI:
    def __init__(self):
        self.api_key = os.environ.get("BINANCE_API_KEY")
        self.api_secret = os.environ.get("BINANCE_API_SECRET")
        self.client = Client(self.api_key, self.api_secret)

    def get_account_balance(self):
        account = self.client.get_account()
        return float(account['balances'][0]['free'])

–ó–¥–µ—Å—å –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å BinanceAPI –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API –±–∏—Ä–∂–∏ Binance. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á –∏ —Å–µ–∫—Ä–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã. –û–¥–Ω–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π –∫–ª–∞—Å—Å–∞ - —ç—Ç–æ get_account_balance, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –Ω–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–∞–π–ª—É bot.py:

python
from api import BinanceAPI
import time

class TradingBot:
    def __init__(self):
        self.api = BinanceAPI()

    def run(self):
        while True:
            balance = self.api.get_account_balance()
            print("Balance: {0:.2f}".format(balance))
            # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.


            time.sleep(5)

–í —Ñ–∞–π–ª–µ bot.py –º—ã —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å TradingBot, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å BinanceAPI –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∞–ª–∞–Ω—Å–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç–æ—Ä–≥–æ–≤–ª–µ–π. –ú—ã —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞–µ–º –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –ø–æ–∫–∞ –º—ã –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–∞—à –±–æ—Ç. –í –∑–∞–¥–µ—Ä–∂–∫–∞—Ö –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏ —Ü–∏–∫–ª–∞ - 5 —Å–µ–∫—É–Ω–¥.

–≠—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º, –Ω–æ –º—ã —Å–º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ –Ω–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –±–∞–∑–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–ü—Ä–æ–¥–æ–ª–∂–∏–º.

–í–æ—Ç —á–∞—Å—Ç—å –∫–æ–¥–∞ –∏–∑ —Ñ–∞–π–ª–∞ bot.py:

python
from binance.enums import *
from binance.client import Client
import talib.abstract as ta
from uuid import uuid4
import sys
import threading, queue
from datetime import datetime, timedelta
import json
import os.path
import pandas as pd
import time

from api import BinanceAPI

# global variables
q = queue.Queue()
access_token = '_your_api_token'
secret_token = '_your_secret_token'
candles = []
lock = threading.Lock()
user_candles = {}


–≠—Ç–æ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ "bot.py", –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã, –æ–ø–∏—Å—ã–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ BinanceAPI –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞ "api.py", –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ–¥–∫–ª—é—á–∏–ª–∏.

–°–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫ –∏–∑ —ç—Ç–æ–≥–æ –∂–µ —Ñ–∞–π–ª–∞:

python
class StrategyTester:

    def __init__(self, symbol, start_date, end_date, klines_date_format):
        # Function that iterates over all candles
        self.run = self.backTest

        # Candles data
        self.candles = []

        self.client = Client(access_token, secret_token)
        self.symbol = symbol
        self.klines_date_format = klines_date_format

        self.start_date = start_date
        self.end_date = end_date
        self.interval = KLINE_INTERVAL_1MINUTE

        self.KDJDayPeriod = 9
        self.KDJFastKPeriod = 3
        self.KDJSlowKPeriod = 3
        self.KDJSlowDPeriod = 3

        self.loopSleep = 5
        
        self.readCandles()

    #--------------------------------------------------------------------------------
    # readCandles()
    #
    # log in to binance and read k lines since start_date until end_date (in minutes interval)
    # load candles from binance and append to self.candles filtered to only symbol we are
    # testing with
    #--------------------------------------------------------------------------------
    def readCandles(self):
        # Download all binance candles
        all_klines = self.client.get_historical_klines(self.symbol, self.interval, self.start_date,
                                                        self.end_date, limit=1000)
        klines = [x for x in all_klines if x[0] > 0]

        # Filter candles to only our symbol
        filtered_klines = list(filter(lambda x: x[0] != None and
                                            x[1] != None and
                                            x[2] != None and
                                            x[3] != None and
                                            x[4] != None and
                                            x[5] != None and
                                            x[6] != None and
                                            x[7] == self.symbol and
                                            int(x[0]) >= int(time.mktime(self.start_date.timetuple())*1000) and
                                            int(x[0]) <= int(time.mktime(self.end_date.timetuple())*1000),
                                      klines))
        # Build candles array
        for kline in filtered_klines:
            self.candles.append({
                'open_time': kline[0],
                'open': kline[1],
                'high': kline[2],
                'low': kline[3],
                'close': kline[4],
                'volume': kline[5],
                'close_time': kline[6],
                'symbol': kline[7],
                'quote_asset_volume': kline[8],
                'number_of_trades': kline[9],
                'taker_buy_base_av': kline[10],
                'taker_buy_quote_av': kline[11],

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
                'ignore': kline[12]
            })


–ó–¥–µ—Å—å –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –∫–ª–∞—Å—Å StrategyTester. –û–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –±–∏—Ä–∂–∏ Binance. –ú—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ readCandles, –∫–æ—Ç–æ—Ä—ã–π —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å start_date –ø–æ end_date. –î–∞–ª–µ–µ –º—ã —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ö –≤ –≤–∏–¥–µ —Å–≤–µ—á–µ–π (–æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ "–æ—Ç–∫—Ä—ã—Ç–∏–µ —Ü–µ–Ω—ã", "–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞", "–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞", "—Ü–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è", "–æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤" –∏ —Ç.–¥.). –ú—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.

–¢–µ–ø–µ—Ä—å —è –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é —á–∞—Å—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ "api.py":

python
# binance API URL
BASE_URL = 'https://api.binance.com'
API_URL = BASE_URL + '/api'
API_WEBSOCKET_URL = 'wss://stream.binance.com:9443/'

class BinanceAPI:

    def __init__(self, access_token = None, secret_token = None):
        self._access_token = access_token
        self._secret_token = secret_token
        self._nonce = str(uuid4())
        self._headers = {}
        
        if access_token and secret_token:
            self._headers = {
                'X-MBX-APIKEY': access_token
            }

    #--------------------------------------------------------------------------------
    # getSymbols()
    #
    # Get all available symbols
    #--------------------------------------------------------------------------------
    def getSymbols(self):
        url = '%s/v1/exchangeInfo' % API_URL
        response = requests.get(url)
        content = response.content.decode('utf-8')
        data = json.loads(content)
        return data['symbols']

    #--------------------------------------------------------------------------------
    # getPrice(symbol)
    #
    # Get symbol price
    #--------------------------------------------------------------------------------
    def getPrice(self, symbol):
        url = '%s/v3/ticker/price' % API_URL
        response = requests.get(url + '?symbol=' + symbol)
        content = response.content.decode('utf-8')
        data = json.loads(content)
        return float(data['price'])


–ó–¥–µ—Å—å –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å BinanceAPI, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∏—Ä–∂–µ–π Binance —á–µ—Ä–µ–∑ –∏—Ö API. –û–Ω –∏–º–µ–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥ getPrice, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã.

–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å API –±–∏—Ä–∂–∏ Binance –∏–ª–∏ Coinbase –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç–µ –±–∏—Ä–∂–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π API-–∫–ª—é—á. –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª api.py, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª–∞—Å—Å—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –±–∏—Ä–∂–∏. –í–æ—Ç –∫–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–∞—á–∞–ª–æ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞:


import requests
import json

class BinanceAPI:
    def __init__(self, api_key, api_secret):
        self.api_key = api_key
        self.api_secret = api_secret
        self.base_url = "https://api.binance.com"
        self.headers = {"X-MBX-APIKEY": self.api_key}

    def get_timestamp(self):
        response = requests.get(self.base_url + "/api/v3/time")
        response_json = json.loads(response.text)
        return response_json["serverTime"]

–í —ç—Ç–æ–º –∫–æ–¥–µ –º—ã —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å BinanceAPI –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ get_timestamp(), –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±–∏—Ä–∂–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö. –¢–∞–∫–∂–µ –º—ã —Å–æ–∑–¥–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è API-–∫–ª—é—á–∞, —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ –±–∞–∑–æ–≤–æ–≥–æ URL API.

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ–º –Ω–∞—à –±–æ—Ç. –î–ª—è —ç—Ç–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª bot.py, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª–∞—Å—Å –¥–ª—è –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞. –í–æ—Ç –∫–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–∞—á–∞–ª–æ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞:


import time
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import ta
from api import BinanceAPI

class TradingBot:
    def __init__(self, api_key, api_secret):
        self.api = BinanceAPI(api_key, api_secret)
        self.trade_symbol = "BTCUSDT"
        self.trade_info = {"symbol": self.trade_symbol, "side": "", "type": "", "quantity": "", "price": "", "stopPrice": "", "workingType": "", "timestamp": ""}
        self.trade_signals = {"RSI_OVERBOUGHT": False, "RSI_OVERSOLD": False, "GOLDEN_CROSS": False, "DEATH_CROSS": False}
        self.balance = self.get_balance()
        self.trade_history = self.get_trade_history()
        self.candlesticks = self.get_candlesticks()

    def get_balance(self):
        """
        –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        response = self.api.get_signed("/api/v3/account")
        return response["balances"]

–ó–¥–µ—Å—å –º—ã —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å TradingBot –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ get_balance(), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –±–∏—Ä–∂–µ.

–¢–∞–∫–∂–µ –º—ã —Å–æ–∑–¥–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è API-–æ–±—ä–µ–∫—Ç–∞, —Å–∏–º–≤–æ–ª–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–¥–µ–ª–∫–∞—Ö, —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –±–∞–ª–∞–Ω—Å–∞, –∏—Å—Ç–æ—Ä–∏–∏ —Å–¥–µ–ª–æ–∫ –∏ —Å–≤–µ—á–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤.

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∏–∫–æ–º –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É matplotlib, –∞ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ - ta (Technical Analysis Library). –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –≤ —Ñ–∞–π–ª–µ requirements.txt –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:


matplotlib
ta
> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–•–æ—Ä–æ—à–æ, –¥–∞–≤–∞–π –Ω–∞—á–Ω–µ–º —Å —Ñ–∞–π–ª–∞ requirements.txt. –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ. –í–æ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:


ccxt==1.54.60
numpy==1.20.3
pandas==1.3.2
python-binance==1.0.12


–ü–æ —Å–º—ã—Å–ª—É, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É CCXT –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∏—Ä–∂–µ–π, –±–∏–±–ª–∏–æ—Ç–µ–∫—É NumPy –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –±–∏–±–ª–∏–æ—Ç–µ–∫—É Pandas –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –∫–ª–∏–µ–Ω—Ç –¥–ª—è –±–∏—Ä–∂–∏ Binance - python-binance.

–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ß—Ç–æ –±—ã –Ω–µ –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –ø–æ –æ—á–µ—Ä–µ–¥–∏, –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫–æ–º–∞–Ω–¥–æ–π pip freeze:


pip freeze > requirements.txt


–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –¥—Ä—É–≥–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ö–æ—Ç—è—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞—à –∫–æ–¥, –∏–º –Ω—É–∂–Ω–æ –≤—Å–µ–≥–æ –ª–∏—à—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å:


pip install -r requirements.txt


–ß—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ requirements.txt.

–î–∞–ª–µ–µ –ø–µ—Ä–µ–π–¥–µ–º –∫ —Ñ–∞–π–ª—É api.py, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –±–∏—Ä–∂–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –í–æ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

python
import ccxt

class BinanceAPI:
    def __init__(self, api_key, secret_key):
        self.exchange = ccxt.binance({
            'apiKey': api_key,
            'secret': secret_key,
            'enableRateLimit': True,
        })

    def get_klines(self, symbol, interval):
        return self.exchange.fetch_ohlcv(symbol, interval)


–≠—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∞—Å—Å BinanceAPI, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –±–∏—Ä–∂–∏ Binance –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ü–µ–Ω–∞—Ö. 
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CCXT –±–∏–±–ª–∏–æ—Ç–µ–∫—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –æ–±—ä–µ–∫—Ç–∞ –±–∏—Ä–∂–∏.–ó–¥–µ—Å—å –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –∫–ª—é—á API –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞.
–ó–∞—Ç–µ–º —É –Ω–∞—Å –µ—Å—Ç—å –º–µ—Ç–æ–¥ get_klines, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–≤–µ—á–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–∏–ª–∏ candlesticks) –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏. –¢–∞–∫–∂–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ fetch_ohlcv –∏–∑ CCXT, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–π–¥–µ–º –∫ —Ñ–∞–π–ª—É bot.py, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π. –≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–µ–ª–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å TradingBot - –Ω–∞—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç. –í–æ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

python
import time
import numpy as np
import pandas as pd
from api import BinanceAPI
from indicators import RSI


class TradingBot:
    def __init__(self, api_key, secret_key, symbol, interval):
        self.api = BinanceAPI(api_key, secret_key)
        self.symbol = symbol
        self.interval = interval
        self.position = None

    def is_position_open(self):
        return self.position is not None

    def execute_trade(self, buy_sell, quantity):
        try:
            order = self.api.exchange.create_order(
                symbol=self.symbol,
                type='MARKET',
                side=buy_sell.upper(),
                amount=quantity
            )
            print(order)
        except Exception as e:
            print(f"Error executing {buy_sell} trade: {e}")

    def entry_rules(self, df):
        # –¥–æ–±–≤–∞—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å—å
        # —Ç—É—Ç –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é
        # –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ–º –ø–æ–∫—É–ø–∞—Ç—å, –µ—Å–ª–∏ RSI –º–µ–Ω—å—à–µ 30.
        # –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ª–æ–≥–∏–∫—É –∑–¥–µ—Å—å, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞.
        # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª –Ω–∞ –≤—Ö–æ–¥
        # –∏–ª–∏ False, –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–∞ –∏–ª–∏ —Å–∏–≥–Ω–∞–ª–∞ –Ω–µ—Ç
        # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ indicators.py, –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RSI
        if self.is_position_open():
            return False
            
        if RSI(df['Close'].values, 14)[-1] < 30:

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
            return True

        return False

    def exit_rules(self, df):
        # —Ç—É—Ç –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
        # –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ–º –ø—Ä–æ–¥–∞–≤–∞—Ç—å, –µ—Å–ª–∏ RSI –±–æ–ª—å—à–µ 70.
        # –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ª–æ–≥–∏–∫—É –∑–¥–µ—Å—å, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞.
        # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —Å–∏–≥–Ω–∞–ª –Ω–∞ –≤—ã—Ö–æ–¥
        # –∏–ª–∏ False, –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ –∏–ª–∏ —Å–∏–≥–Ω–∞–ª–∞ –Ω–µ—Ç
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏
        if not self.is_position_open():
            return False
        # –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω RSI
        if RSI(df['Close'].values, 14)[-1] > 70:
            return True

        return False

    def get_candles(self):
        klines = self.api.get_klines(self.symbol, self.interval)

        df = pd.DataFrame(klines, columns=['timestamp', 'Open', 'High', 'Low', 'Close', 'volume', 'timestamp2', 'Close_time',
                                           'Quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore'])

        df['timestamp'] = pd.to_datetime(df['timestamp'], unit='ms')

        df.set_index('timestamp', inplace=True)

        df.drop(['timestamp2', 'Close_time', 'volume', 'Quote_asset_volume', 'number_of_trades',
                 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore'], axis=1, inplace=True)

        df['Open'] = df['Open'].astype(float)
        df['High'] = df['High'].astype(float)
        df['Low'] = df['Low'].astype(float)
        df['Close'] = df['Close'].astype(float)

        return df

    def run(self):
        while True:
            df = self.get_candles()
            # –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é
            if self.entry_rules(df):
                self.execute_trade('BUY', 0.1)
                self.position = 'LONG'
            # –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
            elif self.exit_rules(df):
                self.execute_trade('SELL', 0.1)
                self.position = None

            time.sleep(60)  # –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ 60 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ–º


–ö–ª–∞—Å—Å TradingBot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–¥–µ–ª–æ–∫ –∏ –∑–∞–ø—É—Å–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.

–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –∑–∞–ø—É—â–µ–Ω –≤ –º–µ—Ç–æ–¥–µ run(), –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—â–µ–Ω –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ. –í –Ω–µ–º –º—ã –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–π –±–∏—Ä–∂–∏ (–º–µ—Ç–æ–¥ get_candles()), –ø—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é –∏, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–¥–µ–ª–∫—É (–º–µ—Ç–æ–¥ execute_trade()). –ú—ã —Ç–∞–∫–∂–µ –∏–º–µ–µ–º –º–µ—Ç–æ–¥—ã entry_rules() –∏ exit_rules(), –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–∑–∏—Ü–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

–¢–∞–∫–∂–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä RSI, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ indicators.py. 

–í —Ñ–∞–π–ª–µ indicators.py –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RSI:

python
import numpy as np

def RSI(close, period):
    """
    –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ RSI.
    :param close: Pandas Series —Å —Ü–µ–Ω–∞–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞.
    :param period: –ß–∏—Å–ª–æ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è —Ä–∞—Å—Å—á–µ—Ç–∞.
    :return: numpy array —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ RSI.
    """
    delta = close.diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=period).mean()
    avg_loss = loss.rolling(window=period).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    return rsi.values


–ó–¥–µ—Å—å –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é RSI(), –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –∏ –ø–µ—Ä–∏–æ–¥ –¥–ª—è —Ä–∞—Å—Å—á–µ—Ç–∞. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Pandas, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–∏–≥—Ä—ã—à–∞ –∏ –ø–æ—Ç–µ—Ä—å. –ó–∞—Ç–µ–º –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞ –∏ –ø–æ—Ç–µ—Ä—å –∑–∞ –ø–µ—Ä–∏–æ–¥, –∏ –∑–∞—Ç–µ–º –≤—ã—á–∏—Å–ª—è–µ–º RSI –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–ö–ª–∞—Å—Å TradingBot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ RSI –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –≤ entry_rules() –∏ exit_rules(), —á—Ç–æ–±—ã –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ—Ä–≥–æ–≤–ª–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ make_trade_decision. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –∞–∫—Ç–∏–≤–∞, —Ü–µ–Ω—É –Ω–∞ –ø–æ–∫—É–ø–∫—É –∏ –ø—Ä–æ–¥–∞–∂—É, –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞ (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å). –í–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –ª–æ–≥–∏–∫–∏ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –º–µ—Ç–æ–¥–∞ make_trade_decision:

python
def make_trade_decision(self, balance: float, buy_price: float, sell_price: float, open_orders: List[Dict]) -> str:
    if self.ema30 > self.ema100:
        if self.current_trend == "SHORT" and self.trend_since > self.trend_change_len:
            return self.open_order("BUY", buy_price, balance*0.5)
        else:
            return "HOLD"
    elif self.ema30 < self.ema100:
        if self.current_trend == "LONG" and self.trend_since > self.trend_change_len:
            return self.open_order("SELL", sell_price, self.asset_balance*0.5)
        else:
            return "HOLD"
    else:
        return "HOLD"

–ú–µ—Ç–æ–¥ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –Ω–∞ 30 –∏ 100 –ø–µ—Ä–∏–æ–¥–∞—Ö, –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ —Ç–µ–∫—É—â–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ –ø–æ–∫—É–ø–∫–µ, –ø—Ä–æ–¥–∞–∂–µ –∏–ª–∏ –æ–± —É–¥–µ—Ä–∂–∞–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–∏.
–•–æ—Ä–æ—à–æ, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –∫–ª–∞—Å—Å–∞ API, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –Ω–∞ –±–∏—Ä–∂–µ. 

python
class API:
    def __init__(self, exchange_name: str, api_key: str, api_secret: str):
        self.exchange_name = exchange_name
        self.client = None
        if self.exchange_name == 'Binance':
            self.client = Client(api_key, api_secret)
        elif self.exchange_name == 'Coinbase':
            self.client = cbpro.AuthenticatedClient(api_key, api_secret)

    def get_balance(self):
        if self.exchange_name == 'Binance':
            account_balance = self.client.get_account()['balances']
            balances = {}
            for coin in account_balance:
                if float(coin['free']) > 0:
                    balances[coin['asset']] = float(coin['free'])
            return balances
        elif self.exchange_name == 'Coinbase':
            account_balance = self.client.get_accounts()
            balances = {}
            for account in account_balance:
                if float(account['balance']) > 0:
                    balances[account['currency']] = float(account['balance'])
            return balances

–í —ç—Ç–æ–º –∫–ª–∞—Å—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API –±–∏—Ä–∂–∏ Binance –∏–ª–∏ Coinbase –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ. –§—É–Ω–∫—Ü–∏—è get_balance –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –±–∞–ª–∞–Ω—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç—Å—è –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–û—Ç–ª–∏—á–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å —Ñ–∞–π–ª–∞ api.py. –í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –º—ã –±—É–¥–µ–º –æ–ø–∏—Å—ã–≤–∞—Ç—å –∫–ª–∞—Å—Å ExchangeAPI, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API –±–∏—Ä–∂–∏.

python
import requests
import time
import hmac
import hashlib

class ExchangeAPI:
    def __init__(self, api_key, api_secret):
        self.API_KEY = api_key
        self.API_SECRET = api_secret
        self.endpoint = 'https://api.binance.com'

    def sign_request(self, params):
        params['timestamp'] = int(time.time() * 1000)
        query_string = '&'.join([f"{k}={v}" for k, v in params.items()])
        signature = hmac.new(self.API_SECRET.encode(), query_string.encode(), hashlib.sha256).hexdigest()
        params['signature'] = signature
        return params

    def get_price(self, symbol, ticker):
        response = requests.get(f"{self.endpoint}/api/v3/ticker/price", params={'symbol': symbol+ticker})
        return response.json()['price']

    def get_balance(self):
        params = self.sign_request({'timestamp': int(time.time() * 1000)})
        headers = {'X-MBX-APIKEY': self.API_KEY}
        response = requests.get(f"{self.endpoint}/api/v3/account", headers=headers, params=params)
        balances = {i['asset']: i for i in response.json()['balances']}
        return balances


–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: requests - –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API, time - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º, hmac –∏ hashlib - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–∞.

–ó–∞—Ç–µ–º –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å ExchangeAPI. –ï–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ - api_key –∏ api_secret, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –±–∏—Ä–∂–∏.

–ú–µ—Ç–æ–¥ sign_request —Å–æ–∑–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ params. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –∏ —Å–æ–∑–¥–∞–µ—Ç SHA256 —Ö–µ—à –æ—Ç —Å—Ç—Ä–æ–∫–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º. –ü–æ–¥–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ª–æ–≤–∞—Ä—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è.

–ú–µ—Ç–æ–¥ get_price –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞—Ä—ã symbol/ticker. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –±–∏—Ä–∂–∏ –º–µ—Ç–æ–¥ GET /api/v3/ticker/price.

–ú–µ—Ç–æ–¥ get_balance –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –±–∏—Ä–∂–∏ –º–µ—Ç–æ–¥ GET /api/v3/account. –°–Ω–∞—á–∞–ª–∞ –º—ã —Å–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ sign_request, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º —Å –ø–æ–º–æ—â—å—é —Ö—ç–¥–µ—Ä–∞ X-MBX-APIKEY –Ω–∞—à–µ API KEY –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –±–∏—Ä–∂—É. –í —Ö–æ–¥–µ –∑–∞–ø—Ä–æ—Å–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–∞—Ö –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–°–ª–µ–¥—É—é—â–∏–º —Ñ–∞–π–ª–æ–º, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ—Å–º–æ—Ç—Ä–∏–º, –±—É–¥–µ—Ç bot.py. –í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –º—ã –æ–ø–∏—à–µ–º –¥–≤–∞ –∫–ª–∞—Å—Å–∞: TradingBot –∏ TradingStrategy.

python
from api import ExchangeAPI

class TradingStrategy:
    def __init__(self, exchange_api):
        self.exchange_api = exchange_api

    def buy(self):
        pass

    def sell(self):
        pass

    def run(self):
        pass


class TradingBot:
    def __init__(self, exchange, trading_strategy):
        self.exchange = exchange
        self.trading_strategy = trading_strategy

    def start(self):
        self.trading_strategy.run()


–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å ExchangeAPI –∏–∑ –º–æ–¥—É–ª—è api. –î–∞–ª–µ–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å TradingStrategy. –ï–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç exchange_api - —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ ExchangeAPI, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API –±–∏—Ä–∂–∏. –ó–∞—Ç–µ–º –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥—ã buy - –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã, sell - –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –∏ run - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
–ö–ª–∞—Å—Å TradingBot —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç exchange - —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ ExchangeAPI –∏ –æ–±—ä–µ–∫—Ç trading_strategy - —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TradingStrategy. –ú–µ—Ç–æ–¥ start –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.

–ü–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤, –æ–ø—Ä–µ–¥–µ–ª–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ —Ñ–∞–π–ª–µ utils.py.

python
import math

def round_down(n, decimals=0):
    multiplier = 10 ** decimals
    return math.floor(n * multiplier) / multiplier

def round_up(n, decimals=0):
    multiplier = 10 ** decimals
    return math.ceil(n * multiplier) / multiplier


–§—É–Ω–∫—Ü–∏—è round_down –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ n —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π decimals –≤–Ω–∏–∑.

–§—É–Ω–∫—Ü–∏—è round_up –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ n —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π decimals –≤–≤–µ—Ä—Ö.

–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–æ—Ä–≥–æ–≤.

–í —Ñ–∞–π–ª–µ strategies.py –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª–∞—Å—Å SimpleStrategy, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ü–µ–Ω.

python
from datetime import datetime, timedelta
from random import randint
from utils import round_down, round_up

class SimpleStrategy(TradingStrategy):
    def __init__(self, exchange_api, symbol, ticker, risk_tolerance=0.01, investment_amount=100, interval=30):
        super().__init__(exchange_api)
        self.symbol = symbol
        self.ticker = ticker
        self.risk_tolerance = risk_tolerance
        self.investment_amount = investment_amount
        self.interval = interval

    def get_next_price(self):
        price = float(self.exchange_api.get_price(self.symbol, self.ticker))
        variance = randint(-10, 10) * self.risk_tolerance * price
        next_price = round_down(price + variance, 2)
        return next_price

    def buy(self):
        balance = self.exchange_api.get_balance()[self.ticker]['free']
        if float(balance) > 0:
            return
        next_price = self.get_next_price()
        amount = round_down(self.investment_amount / next_price, 4)
        self.exchange_api.place_order(
            symbol=self.symbol+self.ticker,
            side='BUY',
            type='LIMIT',
            timeInForce='GTC',
            quantity=amount,
            price=next_price
        )

    def sell(self):
        balance = self.exchange_api.get_balance()[self.ticker]['free']
        if float(balance) == 0:
            return
        price = float(self.exchange_api.get_price(self.symbol, self.ticker))
        variance = randint(-10, 10) * self.risk_tolerance * price
        next_price = round_up(price + variance, 2)
        self.exchange_api.place_order(
            symbol=self.symbol+self.ticker,
            side='SELL',
            type='LIMIT',
            timeInForce='GTC',
            quantity=balance,
            price=next_price
        )

    def run(self):
        while True:
            now = datetime.now()
            if now.minute % self.interval == 0:
                self.sell()
                self.buy()
            time.sleep(60)


–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ SimpleStrategy –ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ ExchangeAPI, —Å–∏–º–≤–æ–ª –∏ —Ç–∏–∫–µ—Ä –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏, —Ä–∏—Å–∫-—Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å, —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤ –º–∏–Ω—É—Ç–∞—Ö –º–µ–∂–¥—É —Å–¥–µ–ª–∫–∞–º–∏.

–ú–µ—Ç–æ–¥ get_next_price –≤—ã—á–∏—Å–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Ü–µ–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –∏ —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∏ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã. –†–∞–∑–º–µ—Ä –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ [-10%; +10%] –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
–ú–µ—Ç–æ–¥—ã buy –∏ sell —Ä–µ–∞–ª–∏–∑—É—é—Ç –ø–æ–∫—É–ø–∫—É –∏ –ø—Ä–æ–¥–∞–∂—É –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ü–µ–Ω–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ place_order –æ–±—ä–µ–∫—Ç–∞ ExchangeAPI.

–ú–µ—Ç–æ–¥ run –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∂–¥—ã–µ interval –º–∏–Ω—É—Ç –ø—Ä–æ–¥–∞–µ—Ç –∏ –∑–∞—Ç–µ–º –ø–æ–∫—É–ø–∞–µ—Ç –∑–∞–¥–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ get_next_price.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–•–æ—Ä–æ—à–æ, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å —Ñ–∞–π–ª–∞ requirements.txt:


ccxt==1.39.63
python-binance==1.0.12
Flask==1.1.2
Flask-Cors==3.0.10


–≠—Ç–æ —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –±–æ—Ç–∞. 

–î–∞–ª–µ–µ, –≤ —Ñ–∞–π–ª–µ api.py —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∫–ª–∞—Å—Å Exchange —Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∏—Ä–∂–µ. –ö–æ–¥:

python
import ccxt
from binance.client import Client
from binance.exceptions import BinanceAPIException

class Exchange:
    def __init__(self, exchange, api_key='', secret_key=''):
        self.exchange = exchange
        self.api_key = api_key
        self.secret_key = secret_key
        self.client = None
        self.ccxt_exchange = None
        self.load_exchange()

    def load_exchange(self):
        try:
            if self.exchange == 'binance':
                self.client = Client(self.api_key, self.secret_key)
            else:
                self.ccxt_exchange = getattr(ccxt, self.exchange)({
                    'apiKey': self.api_key,
                    'secret': self.secret_key,
                })
        except (ccxt.ExchangeError, BinanceAPIException):
            raise Exception(f"Error loading exchange {self.exchange}")


–í —ç—Ç–æ–º –∫–ª–∞—Å—Å–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç Exchange, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∏—Ä–∂–µ. –í __init__ –º–µ—Ç–æ–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –º–µ—Ç–æ–¥ load_exchange() –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –±–∏—Ä–∂–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.

–î–∞–ª–µ–µ, –≤ —Ñ–∞–π–ª–µ bot.py —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∫–ª–∞—Å—Å TradingBot, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç–æ—Ä–≥–æ–≤–ª—é. –ö–æ–¥:

python
from api import Exchange

class TradingBot:
    def __init__(self, exchange, api_key, api_secret):
        self.exchange = Exchange(exchange, api_key, api_secret)
        self.symbols = self.exchange.get_symbols()
        self.strategy = None
        self.order = None
        self.balance = {}
        self.positions = {}
        self.trade_amount = 0
    
    def update_balance(self):
        self.balance = self.exchange.get_balance()
    
    def update_positions(self):
        self.positions = self.exchange.get_positions() if 'binance' in self.exchange.exchange else {}
    
    def get_trade_amount(self):
        if self.trade_amount:
            return self.trade_amount
        
        if 'binance' in self.exchange.exchange:
            exchange_info = self.exchange.client.get_exchange_info()
            base_asset = self.strategy.get_base_asset()
            symbol_info = next(filter(lambda x: x['symbol'] == self.strategy.symbol.upper(), exchange_info['symbols']))

            decimals = symbol_info['filters'][2]['stepSize'].find('1') - 1
            min_qty = float(symbol_info['filters'][2]['minQty'])
            max_qty = float(symbol_info['filters'][2]['maxQty'])
            min_notional = float(symbol_info['filters'][3]['minNotional'])
           
            if self.balance[base_asset]['free'] > min_notional:
                amount = self.balance[base_asset]['free'] * self.strategy.get_allocation()
                amount = max(min(amount, max_qty), min_qty)
                amount = round(amount, decimals)
                self.trade_amount = self.exchange.client.recalc_dust_to_bnb(symbol=self.strategy.symbol.upper(), qty=amount)
                return self.trade_amount


–≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –±–æ—Ç–∞ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç–æ—Ä–≥–æ–≤–ª—é –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –±–∏—Ä–∂–µ. –ú–µ—Ç–æ–¥ __init__ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞. –ú–µ—Ç–æ–¥—ã update_balance() –∏ update_positions() –æ–±–Ω–æ–≤–ª—è—é—Ç –±–∞–ª–∞–Ω—Å –∏ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –±–∏—Ä–∂–µ. –ú–µ—Ç–æ–¥ get_trade_amount() –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
–ù–∞–∫–æ–Ω–µ—Ü, –≤ —Ñ–∞–π–ª–µ bot.py –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ç–æ—Ä–≥–æ–≤–ª–∏. –û–¥–Ω–∏–º –∏–∑ –Ω–∏—Ö —è–≤–ª—è–µ—Ç—Å—è SimpleMovingAverageStrategy:

python
import pandas as pd

class SimpleMovingAverageStrategy:
    def __init__(self, symbol, period_short, period_long):
        self.symbol = symbol
        self.period_short = period_short
        self.period_long = period_long
        
    def get_base_asset(self):
        return self.symbol.split('/')[1]
    
    def get_allocation(self):
        return 0.95
    
    def get_indicator(self, ohlcv_data):
        df = pd.DataFrame(ohlcv_data, columns=['Timestamp', 'Open', 'High', 'Low', 'Close', 'Volume'])
        df['SMA_short'] = df['Close'].rolling(window=self.period_short).mean()
        df['SMA_long'] = df['Close'].rolling(window=self.period_long).mean()
        df.dropna(inplace=True)
        return df['SMA_short'].values[-1], df['SMA_long'].values[-1]

    def get_signal(self, ohlcv_data):
        short_sma, long_sma = self.get_indicator(ohlcv_data)
        if short_sma > long_sma:
            return 'buy'
        elif short_sma < long_sma:
            return 'sell'
        else:
            return 'hold'


–≠—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤. –ú–µ—Ç–æ–¥ get_base_asset() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –∞–∫—Ç–∏–≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã. –ú–µ—Ç–æ–¥ get_allocation() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏. –ú–µ—Ç–æ–¥ get_indicator() –≤—ã—á–∏—Å–ª—è–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –Ω–∞ –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö. –ú–µ—Ç–æ–¥ get_signal() –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–ª–∞—Å—Å TradingBot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å—ã Exchange –∏ SimpleMovingAverageStrategy –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∏—Ä–∂–µ –∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è –∑–∞–¥–∞–Ω–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.

–î–∞, –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ. –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω—ë–º.

requirements.txt:


numpy==1.19.5
pandas==1.1.5
ccxt==1.36.29
python-dotenv==0.17.1

–î–∞–ª—å—à–µ –ø–æ–π–¥—ë–º —Å —Ñ–∞–π–ª–æ–º api.py.

–ö–æ–¥ —Ñ–∞–π–ª–∞ api.py, –∫–æ—Ç–æ—Ä—ã–π –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞–±–æ—Ç—É —Å API –±–∏—Ä–∂–∏, –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:


import requests
import time

class Exchange():
    # –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
    def __init__(self, api_key, secret_key):
        self.api_key = api_key
        self.secret_key = secret_key
        self.base_url = 'https://api.binance.com'

    # –û—Ç–ø—Ä–∞–≤–∫–∞ GET-–∑–∞–ø—Ä–æ—Å–∞ –∫ –±–∏—Ä–∂–µ
    def get_request(self, url, data=None, auth=False):
        response = requests.get(self.base_url + url, params=data, headers=(
            {'Content-type': 'application/json',
            'X-MBX-APIKEY': self.api_key} if auth else None)).json()
        return response

    # –û—Ç–ø—Ä–∞–≤–∫–∞ POST-–∑–∞–ø—Ä–æ—Å–∞ –∫ –±–∏—Ä–∂–µ
    def post_request(self, url, data=None, auth=False):
        response = requests.post(self.base_url + url, json=data, headers=(
            {'Content-type': 'application/json',
            'X-MBX-APIKEY': self.api_key} if auth else None)).json()
        return response

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    def get_account(self):
        return self.get_request('/api/v3/account', None, True)

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫—É—Ä—Å–µ –≤–∞–ª—é—Ç—ã
    def get_ticker(self, symbol):
        return self.get_request('/api/v3/ticker/price', {'symbol': symbol}, False)

–ó–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ GET/POST –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –±–∏—Ä–∂–∏, –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç—ã.

–í —Ñ–∞–π–ª–µ api.py –µ—Å—Ç—å –µ—â–µ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

python
def get_order_book(self, symbol, limit=5):
    return self.get_request('/api/v3/depth', {'symbol': symbol, 'limit': limit}, False)

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–∫–∞–Ω —Ü–µ–Ω (order book) –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞—Ä—ã —Ç–æ—Ä–≥–æ–≤. –ï—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ, —è –º–æ–≥—É –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫—É—Å–æ—á–∫–æ–º –∫–æ–¥–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–ü–æ–Ω—è—Ç–Ω–æ. –í —Ñ–∞–π–ª–µ api.py —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å Binance —Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –±–∏—Ä–∂–∏ Binance. –î–∞–≤–∞–π –ø–æ –ø–æ—Ä—è–¥–∫—É:

1. –ö–ª–∞—Å—Å Binance –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª—å requests –∏ –æ–±—ä—è–≤–ª—è–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å –∞–¥—Ä–µ—Å–æ–º API –∏ –∫–ª—é—á–æ–º –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:


import requests
from typing import List, Union

BASE_API_URL = 'https://api.binance.com'
USER_AGENT = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)'
ACCEPT_LANGUAGE = 'en-US,en;q=0.5'

...




2. –ó–∞—Ç–µ–º –∏–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ __init__ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ api_key –∏ api_secret, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–ª—é—á–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫ API:


class Binance:
    def __init__(self, api_key: str, api_secret: str = ''):
        self.api_key = api_key
        self.api_secret = api_secret
        ... 


3. –î–∞–ª–µ–µ –∏–¥—É—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API, —Ç–∞–∫–∏–µ –∫–∞–∫ get_request –∏ post_request:


class Binance:
    ...
    def get_request(self, path: str, params: dict = None, signed: bool = False) -> dict:
        headers = {
            'User-Agent': USER_AGENT,
            'Accept-Language': ACCEPT_LANGUAGE,
            'X-MBX-APIKEY': self.api_key
        }
        url = BASE_API_URL + path
        response = requests.get(url=url, headers=headers, params=params)
        return response.json()
        
    def post_request(self, path: str, params: dict = None, signed: bool = False) -> dict:
        headers = {
            'User-Agent': USER_AGENT,
            'Accept-Language': ACCEPT_LANGUAGE,
            'X-MBX-APIKEY': self.api_key
        }
        if signed:
            if not self.api_secret:
                raise ValueError('You need to set api_secret parameter first')
 
            params = params or {}
            timestamp = int(time.time() * 1000)

            signature_data = urllib.parse.urlencode(sorted(params.items()))
            signature_data += f'&timestamp={timestamp}'
            signature = hmac.new(self.api_secret.encode(), signature_data.encode(), hashlib.sha256).hexdigest()

            params['timestamp'] = timestamp
            params['signature'] = signature
            
            url = BASE_API_URL + path + '?' + urllib.parse.urlencode(params)
            response = requests.post(url=url, headers=headers)
        else:
            url = BASE_API_URL + path
            response = requests.post(url=url, headers=headers, params=params)

        return response.json()        


4. –ú–µ—Ç–æ–¥ get_ticker_price –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∑–∞–¥–∞–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã:


class Binance:
    ...
    def get_ticker_price(self, symbol: str) -> dict:
        return self.get_request('/api/v3/ticker/price', {'symbol': symbol}, False)
  



5. –ú–µ—Ç–æ–¥ get_order_book –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å—Ç–∞–∫–∞–Ω–µ —Ç–æ—Ä–≥–æ–≤ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä–µ:


class Binance:
    ...
    def get_order_book(self, symbol: str, limit: int = 100) -> dict:
        return self.get_request('/api/v3/depth', {'symbol': symbol, 'limit': limit}, False)


6. get_klines –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ –∑–∞–¥–∞–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏:


class Binance:
    ...
    def get_klines(self, symbol: str, interval: str, limit: int = None) -> List[List[Union[int, float]]]:
        params = {'symbol': symbol, 'interval': interval}
        if limit:
            params['limit'] = limit
        return self.get_request('/api/v3/klines', params, False)


7. –ú–µ—Ç–æ–¥ create_order —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –∏–ª–∏ –ø—Ä–æ–¥–∞–∂—É –∑–∞–¥–∞–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã:

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:

class Binance:
    ...
    def create_order(self, symbol: str, side: str, type: str, quantity: float, price: float or None = None, time_in_force: str = 'GTC', **kwargs) -> dict:
        params = {
            'symbol': symbol,
            'side': side,
            'type': type,
            'timeInForce': time_in_force,
            'quantity': quantity,
        }
        if price:
            params['price'] = price
        params.update(kwargs)
        return self.post_request('/api/v3/order', params, True)


8. –ú–µ—Ç–æ–¥ get_account_info –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∞–ª–∞–Ω—Å–µ –∞–∫–∫–∞—É–Ω—Ç–∞:


class Binance:
    ...
    def get_account_info(self) -> dict:
        return self.get_request('/api/v3/account', None, True)



9. get_open_orders –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤:


class Binance:
    ...
    def get_open_orders(self, symbol: str = None, recv_window: int = None) -> List[dict]:
        params = {}
        if symbol:
            params['symbol'] = symbol
        if recv_window:
            params['recvWindow'] = recv_window
        return self.get_request('/api/v3/openOrders', params, True)



> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
ChatGPT (–±–µ—Å–µ–¥–∞ ‚Ññ 6):
–í—ã–±—Ä–∞–Ω–∞ –í–∞—à–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–æ–ª—å

–ö–æ–Ω–µ—á–Ω–æ, –Ω–∞—á–Ω–µ–º —Å –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π:

python
import logging
import time
from binance.enums import *
from binance.exceptions import *


–ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–¥–∏–º –∫–ª–∞—Å—Å –±–æ—Ç–∞.

python
class Bot:
    def __init__(self, **kwargs):
        self.client = kwargs['client']
        self.symbols = kwargs['symbols']
        self.base_currency = kwargs['base_currency']
        self.quote_currency = kwargs['quote_currency']
        self.symbol = kwargs['symbol']
        self.interval = kwargs['interval']
        self.quantity = kwargs['quantity']
        self.strategy = kwargs['strategy']

        self.log = logging.getLogger('bot')

    def start(self):
        while True:
            try:
                self.run()
            except Exception as e:
                self.log.error(f'Error: {e}', exc_info=True)
            time.sleep(self.interval)


–≠—Ç–æ—Ç –∫–ª–∞—Å—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ client (API-–æ–±—ä–µ–∫—Ç), symbols (–ø–∞—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏), interval (–∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–ø—Ä–æ—Å–∞ –∫–æ—Ç–∏—Ä–æ–≤–æ–∫), etc. –ú–µ—Ç–æ–¥ start() –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –µ–≥–æ —Ä–∞–±–æ—Ç—ã.

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ run(). –û–Ω –±—É–¥–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–∏–º–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏).

python
    def run(self):
        base_balance = self.get_balance(self.base_currency)
        quote_balance = self.get_balance(self.quote_currency)
        self.log.info(f'Base balance: {base_balance} {self.base_currency}, Quote balance: {quote_balance} {self.quote_currency}')

        if self.strategy == 'scalper':
            self.scalper_strategy(base_balance, quote_balance)

        elif self.strategy == 'trend_follower':
            self.trend_following_strategy(base_balance, quote_balance)

        else:
            self.log.warning('No such strategy found')

    def get_balance(self, symbol):
        return float(self.client.get_asset_balance(asset=symbol)['free'])



–ú–µ—Ç–æ–¥ run() –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
- –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å –±–∞–∑–æ–≤–æ–π –∏ –∫–æ—Ç–∏—Ä—É–µ–º–æ–π –≤–∞–ª—é—Ç—ã (base –∏ quote currency);
- –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (scalper –∏–ª–∏ trend_follower);
- –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.

–í –º–µ—Ç–æ–¥–µ get_balance() –º—ã –∑–∞–ø—Ä–æ—Å–∏–º –±–∞–ª–∞–Ω—Å –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç—ã (asset) –Ω–∞ –±–∏—Ä–∂–µ.

python
    def scalper_strategy(self, base_balance, quote_balance):
        self.log.info('Starting scalper strategy')

        try:
            order_book = self.client.get_order_book(symbol=self.symbol, limit=5)
            bid_price = float(order_book['bids'][0][0])
            ask_price = float(order_book['asks'][0][0])
        except Exception as e:
            self.log.error(f'Error: {e}', exc_info=True)
            return

        if bid_price >= ask_price:
            self.log.warning(f'Bid ({bid_price}) price >= Ask ({ask_price}) price')
            return

        current_price = float(self.client.get_symbol_ticker(symbol=self.symbol)['price'])
        quantity = self.calc_quantity(base_balance, current_price)

        if quantity <= 0:
            self.log.warning(f'Not enough {self.base_currency} to place an order')
            return

        if current_price <= bid_price:
            self.log.info(f'Current price ({current_price}) <= bid ({bid_price}), buying {self.base_currency}')
            order = self.client.order_market_buy(symbol=self.symbol, quoteOrderQty=quote_balance)
            self.log.info(f'Filled buy {self.base_currency} market order: {order}')

> ChatGPT | –ú–∞—Ä—Ç–∏ ü¶ì:
        elif current_price >= ask_price:
            self.log.info(f'Current price ({current_price}) >= ask ({ask_price}), selling {self.base_currency}')
            order = self.client.order_market_sell(symbol=self.symbol, quantity=quantity)
            self.log.info(f'Filled sell {self.base_currency} market order: {order}')



–û–¥–Ω–∞ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –∫–æ—Ç–æ—Ä—É—é –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è scalper –∏ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∞—Ö —Å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª—å—é. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ç–æ—Ä–≥–æ–≤–ª—é –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —ç—Ç–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π.

python
    def trend_follower_strategy(self, base_balance, quote_balance):
        self.log.info('Starting trend following strategy')

        try:
            klines = self.client.get_klines(symbol=self.symbol, interval=self.interval)
        except Exception as e:
            self.log.error(f'Error: {e}', exc_info=True)
            return

        if len(klines) < 2:
            self.log.warning(f'Not enough data to analyze for {self.interval} data')
            return

        close_prices = [float(entry[4]) for entry in klines[:-1]]
        last_close = float(klines[-2][4])
        sma = sum(close_prices) / len(close_prices)

        if last_close < sma:
            price = float(self.client.get_symbol_ticker(symbol=self.symbol)['price'])
            quantity = self.calc_quantity(base_balance, price)

            if quantity <= 0:
                self.log.warning(f'Not enough {self.base_currency} to place an order')
                return

            self.log.info(f"Current price: {price}. Last closing price ({last_close}) < SMA ({sma}), buying {self.base_currency}")
            order = self.client.order_market_buy(symbol=self.symbol, quoteOrderQty=quote_balance)
            self.log.info(f"Filled buy {self.base_currency} market order: {order}")
        else:
            self.log.info(f"Last closing price ({last_close}) >= SMA ({sma}), selling {self.base_currency}")
            order = self.client.order_market_sell(symbol=self.symbol, quantity=

...price = self.client.get_symbol_ticker(symbol=self.symbol)[
            'price']
        order = self.client.order_market_sell(symbol=self.symbol, quantity=amount)

        return order

    def execute_buy_order(self, amount):
        price = self.client.get_symbol_ticker(symbol=self.symbol)[
            'price']
        order = self.client.order_market_buy(symbol=self.symbol, quantity=amount)

        return order

    def get_trade_history(self):
        trades = self.client.get_my_trades(symbol=self.symbol)

        return trades

    def calculate_profit(self, trades):
        total = 0
        for trade in trades:
            if trade['isBuyer']:
                total -= float(trade['price']) * float(trade['qty'])
            else:
                total += float(trade['price']) * float(trade['qty'])

        return total

    def run_bot(self):
        # Run bot indefinitely
        while True:
            balance = self.get_balances()
            trades = self.get_trade_history()

            profit = self.calculate_profit(trades)
            total_balance = float(balance['BTC']['free']) + float(balance['BTC']['locked'])

            if profit > 0 and total_balance > 0:
                # Sell 50% of balance
                amount = total_balance / 2
                self.execute_sell_order(amount)

            # Buy if balance is 0
            if total_balance == 0:
                amount = self.trade_size
                self.execute_buy_order(amount)

            time.sleep(600)

if __name__ == '__main__':
    bot = TradingBot('BTCUSDT')
    bot.run_bot()
    print('Bot successfully started')

class Bot:
    def __init__(self, symbol, orderQuantity, stopLossPercentage, apiKey, apiSecret):
        self.symbol = symbol  # –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä—ã –≤–∞–ª—é—Ç, —Å –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'BTCUSDT')
        self.orderQuantity = orderQuantity  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª—é—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º —Ç–æ—Ä–≥—É–µ—Ç –±–æ—Ç –∑–∞ –æ–¥–∏–Ω –æ—Ä–¥–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.01)
        self.stopLossPercentage = stopLossPercentage  # –ü—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è —Å—Ç–æ–ø-–ª–æ—Å—Å –æ—Ä–¥–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1.5%)
        self.client = Client(apiKey, apiSecret)  # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Binance

    def run(self):
        print('Bot successfully started')
        while True:
            try:
                ticker = self.client.get_symbol_ticker(symbol=self.symbol)  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–∏–∫–µ—Ä
                price = float(ticker['price'])  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
                quantity = self.get_available_quantity()  # –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª—é—Ç—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏
                if quantity < self.orderQuantity:  # –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª—é—Ç—ã –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ –æ—Ä–¥–µ—Ä–∞, —Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                    print('Not enough quantity')
                else:
                    order = self.client.order_market_sell(symbol=self.symbol, quantity=self.orderQuantity)  # –°–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
                    # –ï—Å–ª–∏ –æ—Ä–¥–µ—Ä –Ω–µ –±—ã–ª –∏—Å–ø–æ–ª–Ω–µ–Ω, —Ç–æ –ø–µ—Ä–µ–≤—ã—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ –ø–æ –º–∞—Ä–∫–µ—Ç —Ü–µ–Ω–µ
                    if self.check_order_status(order) == 'FILLED':
                        self.create_new_order(price)
                        self.place_stop_loss_order(price)
                        time.sleep(30)  # –ü—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
                    else:
                        self.client.order_market_sell(symbol=self.symbol, quantity=self.orderQuantity)        

            except KeyboardInterrupt:
                sys.exit()

            except Exception as e:
                print('Bot is not working')
                print(e)
                time.sleep(30)  # –ü—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –Ω–∞ 30 —Å–µ–∫—É–Ω–¥

    def check_order_status(self, order):
        return self.client.get_order(symbol=self.symbol, orderId=order['orderId'])['status']

    def get_available_quantity(self):
        balances = self.client.get_account()
        for balance in balances['balances']:
            if balance['asset'] == self.symbol.replace('BTC', '') and float(balance['free']) > 0:
                return float(balance['free'])
        return 0

    def create_new_order(self, price):
        self.orderQuantity = round(((self.orderQuantity * price) * 0.998), 2)

    def place_stop_loss_order(self, price):
        stopPrice = round(price - ((price / 100) * self.stopLossPercentage), 2)
        order = self.client.create_order(
            symbol=self.symbol,
            side=SIDE_SELL,
            type=ORDER_TYPE_STOP_LOSS_LIMIT,
            quantity=self.orderQuantity,
            stopPrice=stopPrice,
            price=stopPrice)
        return order
order = self.client.order_market_sell(symbol=self.symbol, quantity=quantity)
        logging.info("Sell order placed: symbol=%s, quantity=%s", self.symbol, quantity)
        return order

    def cancel_open_orders(self):
        """
        Cancel all open orders for symbol
        :return: None
        """
        orders = self.client.get_open_orders(symbol=self.symbol)
        if not orders:
            logging.info("No open orders found")
            return
        for order in orders:
            canceled_order = self.client.cancel_order(symbol=self.symbol, orderId=order['orderId'])
            logging.info("Canceled order: %s", canceled_order)

    def get_balance(self):
        """
        Get available balance for symbol asset
        :return: balance (float)
        """
        account_info = self.client.get_account()
        balance = 0.0
        for asset in account_info['balances']:
            if asset['asset'] == self.symbol[:-3]:
                balance = float(asset['free'])
                break
        logging.info("Account balance: symbol=%s, balance=%s", self.symbol, balance)
        return balance

    def start(self):
        """
        Start the bot
        :return: None
        """
        logging.info("Bot successfully started")
        while True:
            self.cancel_open_orders()
            balance = self.get_balance()
            if balance > 0:
                buy_quantity = self.calculate_buy_quantity(balance)
                if buy_quantity:
                    self.buy(buy_quantity)
                    self.sell(buy_quantity)
            time.sleep(self.interval)

    def calculate_buy_quantity(self, balance):
        """
        Calculate buy quantity for symbol asset
        :param balance: available balance for symbol asset
        :return: buy_quantity (float)
        """
        if balance <= 0:
            logging.warning("Not enough balance to buy. symbol=%s", self.symbol)
            return None
        ticker = self.client.get_symbol_ticker(symbol=self.symbol)
        bid_price = float(ticker['price'])
        buy_quantity = (balance * self.buy_percentage) / bid_price
        logging.info("Buy quantity calculated: symbol=%s, bid_price=%s, buy_quantity=%s", self.symbol, bid_price,
                     buy_quantity)
        return buy_quantity


if __name__ == "__main__":
    my_bot = Bot()
    my_bot.start()
from api import Binance

class TradeBot:
    def __init__(self, api_key: str, api_secret: str, symbol: str, quantity: float, 
                goal_profit: float, stop_loss: float, interval: int):
        self.client = Binance(api_key, api_secret)
        self.symbol = symbol
        self.quantity = quantity
        self.goal_profit = goal_profit
        self.stop_loss = stop_loss
        self.interval = interval

    def get_price(self):
        ticker = self.client.get_ticker_price(self.symbol)
        return float(ticker['price'])

    def get_balance(self):
        balance = self.client.get_account_info()
        for item in balance['balances']:
            if item['asset'] == self.symbol[:-3]:
                return float(item['free'])
        return 0
    
    def buy(self):
        order = self.client.order_market_buy(symbol=self.symbol, quantity=self.quantity)
        return order

    def sell(self):
        order = self.client.order_market_sell(symbol=self.symbol, quantity=self.quantity)
        return order

    def start(self):
        print('Bot —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω')
        while True:
            try:
                price = self.get_price()
                balance = self.get_balance()
                if price / self.goal_profit >= self.get_price() and balance > self.quantity:
                    self.sell()
                elif price /self.stop_loss <= self.get_price() and balance > self.quantity:
                    self.sell()
                elif balance == 0:
                    self.buy()
                time.sleep(self.interval)
            except Exception as error:
                print(error)
                time.sleep(5)
–í —Ñ–∞–π–ª–µ bot.py –Ω–∞–ø–∏—Å–∞–Ω –∫–ª–∞—Å—Å TradingBot, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞—à–∏–º —Ç–æ—Ä–≥–æ–≤—ã–º –±–æ—Ç–æ–º. 

python
class TradingBot:
    def __init__(self, api_key, api_secret):
        self.client = Client(api_key, api_secret)
        self.symbol = 'BTCUSDT'

–ö–ª–∞—Å—Å TradingBot –∏–º–µ–µ—Ç –¥–≤–∞ –∞—Ç—Ä–∏–±—É—Ç–∞: client –∏ symbol. client - —ç—Ç–æ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Client –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ python-binance, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å API –±–∏—Ä–∂–∏ Binance. –ú—ã –ø–µ—Ä–µ–¥–∞–µ–º –∫–ª—é—á –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ –±–∏—Ä–∂–∏ Binance. symbol - —ç—Ç–æ –ø–∞—Ä–∞ —Ç–æ—Ä–≥—É–µ–º—ã—Ö –≤–∞–ª—é—Ç, –∫–æ—Ç–æ—Ä—É—é –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ–º –±–æ—Ç–µ. 

python
    def get_price(self):
        '''–ü–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã'''

        price = float(self.client.get_symbol_ticker(symbol=self.symbol)['price'])
        return price

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ get_symbol_ticker –æ–±—ä–µ–∫—Ç–∞ client, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã. –ú—ã –ø–µ—Ä–µ–¥–∞–µ–º self.symbol –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–ª—è –º–µ—Ç–æ–¥–∞ get_symbol_ticker –∏ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–∞ 'price' –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ü–µ–Ω—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è.

python
    def buy(self, quantity):
        '''–†–∞–∑–º–µ—â–∞–µ—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É –º–æ–Ω–µ—Ç'''

        order = self.client.order_market_buy(symbol=self.symbol, quantity=quantity)
        return order

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ order_market_buy –æ–±—ä–µ–∫—Ç–∞ client, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É quantity –º–æ–Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ–º order –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è.

python
    def sell(self, quantity):
        '''–†–∞–∑–º–µ—â–∞–µ—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –º–æ–Ω–µ—Ç'''

        order = self.client.order_market_sell(symbol=self.symbol, quantity=quantity)
        return order

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ order_market_sell –æ–±—ä–µ–∫—Ç–∞ client, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É quantity –º–æ–Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ–º order –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è.

python
    def set_stop_loss(self, stop_price, quantity):
        '''–†–∞–∑–º–µ—â–∞–µ—Ç —Å—Ç–æ–ø-–ª–∏–º–∏—Ç –æ—Ä–¥–µ—Ä –¥–ª—è –Ω–∞—à–µ–π –ø–æ–∑–∏—Ü–∏–∏'''

        price = self.get_price()
        limit_price = str(round(price * Decimal(1 - (stop_price / 100)), 2))
        print('Setting stop loss at ' + limit_price)
        
        order = self.client.create_order(symbol=self.symbol, 
                                          side=SIDE_SELL,
                                          type=ORDER_TYPE_STOP_LOSS_LIMIT,
                                          timeInForce=TIME_IN_FORCE_GTC,
                                          quantity=quantity,
                                          price=limit_price,
                                          stopPrice=str(stop_price))
        return order

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ create_order –æ–±—ä–µ–∫—Ç–∞ client, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å—Ç–æ–ø-–ª–∏–º–∏—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É quantity –º–æ–Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã. stop_price —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—É, –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–π –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –Ω–∞—à –æ—Ä–¥–µ—Ä —Å—Ç–æ–ø-–ª–∏–º–∏—Ç, –∞ limit_price –±—É–¥–µ—Ç —Ü–µ–Ω–æ–π, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—â–µ–Ω –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ. 
python
class Bot:
    def __init__(self, coin_pair, interval=5):
        self.api_manager = ApiManager(coin_pair)
        self.order_manager = OrderManager(self.api_manager)
        self.balance_manager = BalanceManager(self.api_manager)
        self.symbol = '_'.join(coin_pair.split('-')).upper()
        self.pending_orders = []

        self.client = Client()
        self.interval = interval

    def start(self):
        print('Bot —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω')
        while True:
            try:
                time.sleep(self.interval)
                self.update_orders()
            except KeyboardInterrupt:
                break

    def update_orders(self):
        closed_orders = []
        for order in self.pending_orders:
            if order.is_closed:
                print(order)
                closed_orders.append(order)
        for order in closed_orders:
            self.pending_orders.remove(order)

–ü—Ä–æ–¥–æ–ª–∂—É –æ–ø—è—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Ñ–∞–π–ª–∞:
python
if 'sell' in signal and self.balance_manager.can_sell:
            order = self.order_manager.create_market_sell_order(
                self.symbol, self.balance_manager.current_stock())
            self.pending_orders.append(order)
            
        time.sleep(self.interval)

–°–ª–µ–¥—É—é—â—É—é —á–∞—Å—Ç—å –∫–æ–¥–∞ –≤—ã—à–ª—é, –∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤.
 –í–æ—Ç —Å–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫ –∫–æ–¥–∞ –∏–∑ —Ñ–∞–π–ª–∞ bot.py:


def main():
    # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç API
    api_params = get_params('api')
    api = Api(api_params['key'], api_params['secret'])

    # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –±–æ—Ç–∞
    bot_params = get_params('bot')
    my_bot = Bot(api, bot_params)

    # –∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    my_bot.start()

if __name__ == '__main__':
    main()

–≠—Ç–∞ —á–∞—Å—Ç—å –∫–æ–¥–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç API –∏ –æ–±—ä–µ–∫—Ç –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∞–º–æ–≥–æ –±–æ—Ç–∞. 

–§—É–Ω–∫—Ü–∏—è main() –æ–±–ª–∞–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π –ª–æ–≥–∏–∫–æ–π:
- –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ API –∏ –±–æ—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
- —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç API;
- –∏—Å–ø–æ–ª—å–∑—É—è API, —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –±–æ—Ç–∞;
- –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ start().

–ù—É –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è if __name__ == '__main__' –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –µ—Å–ª–∏ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞–ø—Ä—è–º—É—é (–∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ –¥—Ä—É–≥–æ–π —Å–∫—Ä–∏–ø—Ç), —Ç–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é main(). 
–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å —Ñ–∞–π–ª–∞ bot.py:

python
class MyBot:
    def __init__(self, api):
        self.api = api
        self.symbol = 'BTCUSDT'
        self.profitable_trade = False
        self.active_orders = []

python
    @staticmethod
    def calculate_profit(open_price, close_price, quantity):
        return (close_price - open_price) * quantity
python
class Bot:
    def __init__(self, api_key, secret_key, symbol, interval):
        self.client = Client(api_key, secret_key)
        self.symbol = symbol
        self.interval = interval
        self.ticks = []
        self.prices = []

python
    def start(self):
        self.get_ticks()
        self.get_prices()
        while True:
            self.trade()

python
    def get_ticks(self):
        def append_tick(tick, ticks):
            tick_time = tick['E']
            tick_close = float(tick['c'])

            ticks.append((tick_time, tick_close))

        ticks = self.client.aggregate_trade_iter(symbol=self.symbol, start_str='1 day ago UTC')
        for tick in ticks:
            append_tick(tick, self.ticks)
            time.sleep(1)

python
    def get_prices(self):
        klines = self.client.get_historical_klines(self.symbol, self.interval, '1 day ago UTC')
        for kline in klines:
            kline_close = float(kline[4])
            self.prices.append(kline_close)
            time.sleep(0.5)

python
    def get_sma(self, window):
        prices = self.prices[-window:]
        return sum(prices) / len(prices)
–ö–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ requirements.txt:


requests
pandas
numpy
python-binance
python-dotenv


–ö–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ api.py:


python
class BinanceAPI:

    def __init__(self, key=None, secret=None):
        self.base_url = 'https://api.binance.com'
        self.key = key
        self.secret = secret
        self.session = requests.Session()

    def _get_headers(self, signed):
        headers = {'Content-Type': 'application/json'}
        if signed:
            query_string = urlencode(params)
            signature = hmac.new(self.secret.encode(), query_string.encode(), hashlib.sha256).hexdigest()
            headers['X-MBX-APIKEY'] = self.key
        return headers

    def _request(self, method, path, params=None, signed=False):
        url = self.base_url + path
        headers = self._get_headers(signed)
        response = self.session.request(method, url, headers=headers, params=params)
        response.raise_for_status()
        return response.json()

    def get_request(self, path, params=None, signed=False):
        return self._request('GET', path, params, signed)

    def post_request(self, path, params=None, signed=False):
        return self._request('POST', path, json=params, signed=signed)

    def get_ticks_price(self, symbol):
        return self.get_request('/api/v3/ticker/price', {'symbol': symbol}, False)

    def get_depth(self, symbol='BTCUSDT', limit=5):
        return self.get_request('/api/v3/depth', {'symbol': symbol, 'limit': limit}, False)



–ö–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ bot.py:


python
class CryptoBot:

    def __init__(self, api_key=None, api_secret=None, trade_limit=1000.0):
        self.trade_limit = trade_limit
        self.api = BinanceAPI(api_key, api_secret)
        self.symbol = 'BTCUSDT'

    def run(self):
        print('Bot successfully started')
        while True:
            tick_price = float(self.api.get_ticks_price(self.symbol)['price'])
            depth = self.api.get_depth(self.symbol)
            bids_sum = sum([float(bid[1]) for bid in depth['bids']])
            asks_sum = sum([float(ask[1]) for ask in depth['asks']])
            if bids_sum > asks_sum:
                order = self.client.order_market_buy(symbol=self.symbol, quantity=self.trade_limit/tick_price)
            else:
                order = self.client.order_market_sell(symbol=self.symbol, quantity=self.trade_limit/tick_price)
            
            print(order)
            time.sleep(5)
. –í —Ñ–∞–π–ª–µ bot.py –µ—Å—Ç—å –µ—â—ë –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è get_current_price(). –í–æ—Ç –µ—ë –∫–æ–¥:


def get_current_price(self):
    """
    Get current price of coin

    :return: current price
    """

    data = self.api.get_price(self.symbol)

    if data:
        return float(data['price'])
    else:
        return None

–¢–∞–∫–∂–µ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏:


def get_order_quantity(self, price, balance):
    """
    Calculate order quantity based on price and available balance

    :param price: price to buy or sell at
    :param balance: available balance
    :return: order quantity
    """

    quantity = (balance * self.risk_percentage) / 100
    return quantity / price

–ò –µ—â—ë –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏:


def buy(self, price):
    """
    Buy coins at a given price

    :param price: price to buy coins at
    """

    balance = self.get_balance() * self.balance_percentage

    if balance <= 0:
        return

    quantity = self.get_order_quantity(price, balance)

    if quantity <= 0:
        return

    order = self.client.order_market_buy(symbol=self.symbol, quantity=quantity)

    if order:
        return True
    else:
        return False

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏:


def sell(self, price):
    """
    Sell coins at a given price

    :param price: price to sell coins at
    """

    quantity = self.get_balance()

    if quantity <= 0:
        return

    order = self.client.order_market_sell(symbol=self.symbol, quantity=quantity)

    if order:
        return True
    else:
        return False

–ò, –Ω–∞–∫–æ–Ω–µ—Ü, –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è main():


def main():
    """
    Main function that runs the bot
    """
    my_bot = CryptoBot()
    my_bot.start()

if __name__ == '__main__':
    main()









